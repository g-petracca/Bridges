vold:process 
	WRITES: 
		allow blkid_untrusted vold:process sigchld;
		allow blkid vold:process sigchld;
		allow fsck_untrusted vold:process sigchld;
		allow fsck vold:process sigchld;
		allow init vold:process transition;
		allow sdcardd vold:process sigchld;
		allow sgdisk vold:process sigchld;
	READS: 
		allow servicemanager vold:process getattr;
	NEVERALLOWS: 

keystore:fd 
	WRITES: 
		allow appdomain keystore:fd use;
		allow -isolated_app keystore:fd use;
		allow binderservicedomain keystore:fd use;
		allow fingerprintd keystore:fd use;
		allow gatekeeperd keystore:fd use;
		allow racoon keystore:fd use;
		allow wpa keystore:fd use;
	READS: 
		allow appdomain keystore:fd use;
		allow -isolated_app keystore:fd use;
		allow binderservicedomain keystore:fd use;
		allow fingerprintd keystore:fd use;
		allow gatekeeperd keystore:fd use;
		allow racoon keystore:fd use;
		allow wpa keystore:fd use;
	NEVERALLOWS: 

keychain_data_file:file 
	WRITES: 
		allow system_server keychain_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain keychain_data_file:file {#getattr#open#read#ioctl#lock#};
		allow installd keychain_data_file:file {{#getattr#open#read#ioctl#lock#}#unlink};
		allow system_app keychain_data_file:file {#getattr#open#read#ioctl#lock#};
		allow system_server keychain_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

-contextmount_type:file 
	WRITES: 
		allow init -contextmount_type:file {#open#read#setattr#};
	READS: 
		allow init -contextmount_type:file {#open#read#setattr#};
	NEVERALLOWS: 

radio_data_file:sock_file 
	WRITES: 
		allow installd radio_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow radio radio_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow installd radio_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow radio radio_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

apk_tmp_file:file 
	WRITES: 
		allow installd apk_tmp_file:file {#{#getattr#open#read#ioctl#lock#}#unlink#};
		allow platform_app apk_tmp_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server apk_tmp_file:file {#relabelfrom#relabelto#};
		allow system_server apk_tmp_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow dex2oat apk_tmp_file:file read;
		allow installd apk_tmp_file:file {#{#getattr#open#read#ioctl#lock#}#unlink#};
		allow platform_app apk_tmp_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server apk_tmp_file:file {#relabelfrom#relabelto#};
		allow system_server apk_tmp_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow untrusted_app apk_tmp_file:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

radio_data_file:dir 
	WRITES: 
		allow installd radio_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow radio radio_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow rild radio_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server radio_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow installd radio_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow radio radio_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow rild radio_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server radio_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server radio_data_file:dir {#getattr#read#search#};
	NEVERALLOWS: 

installd_tmpfs:file 
	WRITES: 
		allow installd installd_tmpfs:file {#read#write#};
	READS: 
		allow installd installd_tmpfs:file {#read#write#};
	NEVERALLOWS: 

tee_data_file:file 
	WRITES: 
		allow tee tee_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow tee tee_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

servicemanager_tmpfs:file 
	WRITES: 
		allow servicemanager servicemanager_tmpfs:file {#read#write#};
	READS: 
		allow servicemanager servicemanager_tmpfs:file {#read#write#};
	NEVERALLOWS: 

bootchart_data_file:dir 
	WRITES: 
		allow shell bootchart_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow adbd bootchart_data_file:dir search;
		allow shell bootchart_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	NEVERALLOWS: 

gatekeeper_data_file:dir 
	WRITES: 
		allow gatekeeperd gatekeeper_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow gatekeeperd gatekeeper_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	NEVERALLOWS: 

-vold_data_file}:file 
	WRITES: 
		allow init -vold_data_file}:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	READS: 
		allow init -vold_data_file}:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

vpn_data_file:dir 
	WRITES: 
		allow ppp vpn_data_file:dir {#open#search#write#add_name#remove_name#};
		allow racoon vpn_data_file:dir {#open#search#write#add_name#remove_name#};
		allow system_server vpn_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow mtp vpn_data_file:dir search;
		allow ppp vpn_data_file:dir {#open#search#write#add_name#remove_name#};
		allow racoon vpn_data_file:dir {#open#search#write#add_name#remove_name#};
		allow system_server vpn_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

bootanim:fd 
	WRITES: 
		allow surfaceflinger bootanim:fd use;
	READS: 
		allow surfaceflinger bootanim:fd use;
	NEVERALLOWS: 

bluetooth:unix_stream_socket 
	WRITES: 
		allow bluetoothdomain bluetooth:unix_stream_socket {#getopt#setopt#getattr#read#write#ioctl#shutdown#};
		allow mediaserver bluetooth:unix_stream_socket connectto;
	READS: 
		allow bluetoothdomain bluetooth:unix_stream_socket {#getopt#setopt#getattr#read#write#ioctl#shutdown#};
	NEVERALLOWS: 

sysfs_wake_lock:file 
	WRITES: 
		allow healthd sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow inputflinger sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow perfprofd sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow healthd sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow inputflinger sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow perfprofd sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold sysfs_wake_lock:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

self:netlink_kobject_uevent_socket 
	WRITES: 
		allow healthd self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow netd self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow rild self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow surfaceflinger self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow system_server self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow ueventd self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow vold self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	READS: 
		allow healthd self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow netd self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow rild self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow surfaceflinger self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow system_server self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow ueventd self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow vold self:netlink_kobject_uevent_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	NEVERALLOWS: 

unencrypted_data_file:dir 
	WRITES: 
		allow init unencrypted_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold unencrypted_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow init unencrypted_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold unencrypted_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

sensors_device:chr_file 
	WRITES: 
		allow system_server sensors_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow system_server sensors_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

wifi_data_file:file 
	WRITES: 
		allow hostapd wifi_data_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow netd wifi_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server wifi_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow wpa wifi_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow hostapd wifi_data_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow netd wifi_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server wifi_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow wpa wifi_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

perfprofd_tmpfs:file 
	WRITES: 
		allow perfprofd perfprofd_tmpfs:file {#read#write#};
	READS: 
		allow perfprofd perfprofd_tmpfs:file {#read#write#};
	NEVERALLOWS: 

self:udp_socket 
	WRITES: 
		allow init self:udp_socket {#create#ioctl#};
		allow netdomain self:udp_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	READS: 
		allow netdomain self:udp_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	NEVERALLOWS: 

mtp_device:chr_file 
	WRITES: 
		allow untrusted_app mtp_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow untrusted_app mtp_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

drm_data_file:dir 
	WRITES: 
		allow drmserver drm_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow drmserver drm_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

devpts:chr_file 
	WRITES: 
		allow adbd devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow appdomain devpts:chr_file {#getattr#read#write#ioctl#};
		allow binderservicedomain devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow dumpstate devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow fsck devpts:chr_file {#read#write#ioctl#getattr#};
		allow fsck_untrusted devpts:chr_file {#read#write#ioctl#getattr#};
		allow init devpts:chr_file {#read#write#open#};
		allow installd devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow netd devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow runas devpts:chr_file {#read#write#ioctl#};
		allow sgdisk devpts:chr_file {#read#write#ioctl#getattr#};
		allow shell devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow toolbox devpts:chr_file {#read#write#getattr#ioctl#};
		allow untrusted_app untrusted_app_devpts:chr_file {#open#getattr#read#write#ioctl#};
		allow vold devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow adbd devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow appdomain devpts:chr_file {#getattr#read#write#ioctl#};
		allow binderservicedomain devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow dumpstate devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow fsck devpts:chr_file {#read#write#ioctl#getattr#};
		allow fsck_untrusted devpts:chr_file {#read#write#ioctl#getattr#};
		allow init devpts:chr_file {#read#write#open#};
		allow installd devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow netd devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow runas devpts:chr_file {#read#write#ioctl#};
		allow sgdisk devpts:chr_file {#read#write#ioctl#getattr#};
		allow shell devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow toolbox devpts:chr_file {#read#write#getattr#ioctl#};
		allow untrusted_app untrusted_app_devpts:chr_file {#open#getattr#read#write#ioctl#};
		allow vold devpts:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

proc_bluetooth_writable:file 
	WRITES: 
		allow bluetooth proc_bluetooth_writable:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow bluetooth proc_bluetooth_writable:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

self:fd 
	WRITES: 
		allow domain self:fd use;
	READS: 
		allow domain self:fd use;
	NEVERALLOWS: 

vold:fifo_file 
	WRITES: 
		allow blkid_untrusted vold:fifo_file {#read#write#getattr#};
		allow blkid vold:fifo_file {#read#write#getattr#};
		allow fsck_untrusted vold:fifo_file {#read#write#getattr#};
		allow fsck vold:fifo_file {#read#write#getattr#};
		allow sdcardd vold:fifo_file {#read#write#getattr#};
		allow sgdisk vold:fifo_file {#read#write#getattr#};
	READS: 
		allow blkid_untrusted vold:fifo_file {#read#write#getattr#};
		allow blkid vold:fifo_file {#read#write#getattr#};
		allow fsck_untrusted vold:fifo_file {#read#write#getattr#};
		allow fsck vold:fifo_file {#read#write#getattr#};
		allow sdcardd vold:fifo_file {#read#write#getattr#};
		allow sgdisk vold:fifo_file {#read#write#getattr#};
	NEVERALLOWS: 

cgroup:dir 
	WRITES: 
		allow dhcp cgroup:dir {#create#write#add_name#};
		allow domain cgroup:dir {#search#write#};
		allow init cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow installd cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow lmkd cgroup:dir {#remove_name#rmdir#};
		allow racoon cgroup:dir {#add_name#create#};
		allow rild cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow sdcardd cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server cgroup:dir {#remove_name#rmdir#};
		allow wpa cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow zygote cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow domain cgroup:dir {#open#getattr#read#search#ioctl#};
		allow domain cgroup:dir {#search#write#};
		allow init cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow installd cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow lmkd cgroup:dir {#remove_name#rmdir#};
		allow rild cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow sdcardd cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server cgroup:dir {#remove_name#rmdir#};
		allow wpa cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow zygote cgroup:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

-shell_data_file:dir 
	WRITES: 
		allow init -shell_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	READS: 
		allow init -shell_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	NEVERALLOWS: 

appdomain:fd 
	WRITES: 
		allow appdomain appdomain:fd use;
		allow binderservicedomain appdomain:fd use;
		allow drmserver appdomain:fd use;
		allow dumpstate appdomain:fd use;
		allow mediaserver appdomain:fd use;
		allow surfaceflinger appdomain:fd use;
		allow system_server appdomain:fd use;
	READS: 
		allow appdomain appdomain:fd use;
		allow binderservicedomain appdomain:fd use;
		allow drmserver appdomain:fd use;
		allow dumpstate appdomain:fd use;
		allow mediaserver appdomain:fd use;
		allow surfaceflinger appdomain:fd use;
		allow system_server appdomain:fd use;
	NEVERALLOWS: 

null_device:chr_file 
	WRITES: 
		allow domain null_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain null_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

fingerprintd_data_file:dir 
	WRITES: 
		allow fingerprintd fingerprintd_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow fingerprintd fingerprintd_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server fingerprintd_data_file:dir {{#open#getattr#read#search#ioctl#}#relabelto};
	NEVERALLOWS: 

gpu_device:chr_file 
	WRITES: 
		allow adbd gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow appdomain gpu_device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#execute#};
		allow -isolated_app gpu_device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#execute#};
		allow bootanim gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow dumpstate gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow adbd gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow appdomain gpu_device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#execute#};
		allow -isolated_app gpu_device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#execute#};
		allow bootanim gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow dumpstate gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow isolated_app gpu_device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#execute#};

dhcp_tmpfs:file 
	WRITES: 
		allow dhcp dhcp_tmpfs:file {#read#write#};
	READS: 
		allow dhcp dhcp_tmpfs:file {#read#write#};
	NEVERALLOWS: 

misc_user_data_file:dir 
	WRITES: 
		allow installd misc_user_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_app misc_user_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow appdomain misc_user_data_file:dir {#open#getattr#read#search#ioctl#};
		allow installd misc_user_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_app misc_user_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

-adbd:process 
	WRITES: 
		allow debuggerd -adbd:process {#ptrace#getattr#};
	READS: 
		allow debuggerd -adbd:process {#ptrace#getattr#};
	NEVERALLOWS: 

-watchdogd:process 
	WRITES: 
		allow debuggerd -watchdogd:process {#ptrace#getattr#};
	READS: 
		allow debuggerd -watchdogd:process {#ptrace#getattr#};
	NEVERALLOWS: 

dev_type:dir 
	WRITES: 
		allow init dev_type:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow ueventd dev_type:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow init dev_type:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow ueventd dev_type:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

shell_data_file:lnk_file 
	WRITES: 
		allow init -shell_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
		allow installd shell_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow shell shell_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow init -shell_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
		allow installd shell_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow shell shell_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow uncrypt shell_data_file:lnk_file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 
		neverallow init shell_data_file:lnk_file read;

iio_device:chr_file 
	WRITES: 
		allow system_server iio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow system_server iio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

inputflinger_tmpfs:file 
	WRITES: 
		allow inputflinger inputflinger_tmpfs:file {#read#write#};
	READS: 
		allow inputflinger inputflinger_tmpfs:file {#read#write#};
	NEVERALLOWS: 

unlabeled:dir 
	WRITES: 
		allow init unlabeled:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#};
		allow installd unlabeled:dir {#getattr#search#relabelfrom#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#rmdir#};
		allow vold unlabeled:dir {#{#open#getattr#read#search#ioctl#}#setattr#relabelfrom#};
	READS: 
		allow init unlabeled:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#};
		allow installd unlabeled:dir {#getattr#search#relabelfrom#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#rmdir#};
		allow kernel unlabeled:dir search;
		allow system_server unlabeled:dir {#open#getattr#read#search#ioctl#};
		allow vold unlabeled:dir {#{#open#getattr#read#search#ioctl#}#setattr#relabelfrom#};
	NEVERALLOWS: 
		neverallow domain unlabeled:dir create;
		neverallow -init unlabeled:dir create;
		neverallow -recovery unlabeled:dir create;

-security_file:sock_file 
	WRITES: 
		allow init -security_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -security_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

graphics_device:chr_file 
	WRITES: 
		allow healthd graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow healthd graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow untrusted_app graphics_device:chr_file {#read#write#};
		neverallow isolated_app graphics_device:chr_file {#read#write#};
		neverallow shell graphics_device:chr_file {#read#write#};

zero_device:chr_file 
	WRITES: 
		allow domain zero_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain zero_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

-system_file:dir 
	WRITES: 
		allow init -system_file:dir {#create#search#getattr#open#read#setattr#ioctl#};
		allow init -system_file:dir relabelto;
		allow init -system_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	READS: 
		allow init -system_file:dir {#create#search#getattr#open#read#setattr#ioctl#};
		allow init -system_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	NEVERALLOWS: 

radio_data_file:lnk_file 
	WRITES: 
		allow installd radio_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow radio radio_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow installd radio_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow radio radio_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

security_file:lnk_file 
	WRITES: 
		allow init -security_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
		allow system_server security_file:lnk_file {#create#rename#unlink#};
	READS: 
		allow domain security_file:lnk_file {#getattr#open#read#ioctl#lock#};
		allow init -security_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
		allow init security_file:lnk_file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 
		neverallow domain security_file:lnk_file {#relabelfrom#relabelto#};
		neverallow -init security_file:lnk_file {#relabelfrom#relabelto#};
		neverallow domain security_file:lnk_file {#create#setattr#unlink#rename#};
		neverallow -system_server security_file:lnk_file {#create#setattr#unlink#rename#};

rtc_device:chr_file 
	WRITES: 
		allow system_server rtc_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow system_server rtc_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

drmserver:process 
	WRITES: 
		allow dumpstate drmserver:process signal;
		allow init drmserver:process transition;
	READS: 
		allow servicemanager drmserver:process getattr;
	NEVERALLOWS: 

vfat:file 
	WRITES: 
		allow appdomain vfat:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow platform_app vfat:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain vfat:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow platform_app vfat:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

{file_type:fifo_file 
	WRITES: 
		allow init {file_type:fifo_file relabelto;
		allow init {file_type:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init {file_type:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

adbd:unix_stream_socket 
	WRITES: 
		allow domain adbd:unix_stream_socket connectto;
		allow domain adbd:unix_stream_socket {#getattr#getopt#read#write#shutdown#};
	READS: 
		allow domain adbd:unix_stream_socket {#getattr#getopt#read#write#shutdown#};
	NEVERALLOWS: 

wpa_tmpfs:file 
	WRITES: 
		allow wpa wpa_tmpfs:file {#read#write#};
	READS: 
		allow wpa wpa_tmpfs:file {#read#write#};
	NEVERALLOWS: 

tee_device:chr_file 
	WRITES: 
		allow drmserver tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow gatekeeperd tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow keystore tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow tee tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow drmserver tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow gatekeeperd tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow keystore tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow tee tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow appdomain tee_device:chr_file {#read#write#};

adbd:process 
	WRITES: 
		allow appdomain adbd:process sigchld;
		allow debuggerd -adbd:process {#ptrace#getattr#};
		allow init adbd:process transition;
		allow runas adbd:process sigchld;
		allow shell adbd:process sigchld;
	READS: 
		allow debuggerd -adbd:process {#ptrace#getattr#};
		allow servicemanager adbd:process getattr;
	NEVERALLOWS: 

domain:process 
	WRITES: 
		allow debuggerd domain:process {#ptrace#getattr#};
		allow debuggerd domain:process {#sigstop#signal#};
		allow dumpstate appdomain:process signal;
		allow init domain:process sigkill;
		allow lmkd appdomain:process sigkill;
		allow system_server appdomain:process {#getsched#setsched#};
		allow system_server appdomain:process {#sigkill#signal#};
		allow vold domain:process {#signal#sigkill#};
		allow zygote appdomain:process dyntransition;
		allow zygote appdomain:process {#getpgid#setpgid#};
	READS: 
		allow debuggerd domain:process {#ptrace#getattr#};
		allow dumpstate domain:process getattr;
		allow servicemanager appdomain:process getattr;
		allow shell domain:process getattr;
		allow system_server appdomain:process {#getsched#setsched#};
		allow zygote appdomain:process {#getpgid#setpgid#};
	NEVERALLOWS: 
		neverallow appdomain domain:process ptrace;
		neverallow appdomain -appdomain:process ptrace;
		neverallow ~domain domain:process {#transition#dyntransition#};
		neverallow domain ~domain:process {#transition#dyntransition#};
		neverallow logd domain:process ptrace;
		neverallow netd domain:process ptrace;

netdomain:dccp_socket 
	WRITES: 
		allow netd netdomain:dccp_socket {read#write#getattr#setattr#getopt#setopt};
	READS: 
		allow netd netdomain:dccp_socket {read#write#getattr#setattr#getopt#setopt};
	NEVERALLOWS: 

-contextmount_type:dir 
	WRITES: 
		allow init -contextmount_type:dir {#open#read#setattr#search#};
	READS: 
		allow init -contextmount_type:dir {#open#read#setattr#search#};
	NEVERALLOWS: 

app_data_file:fifo_file 
	WRITES: 
		allow appdomain app_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow -isolated_app app_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow init -app_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow installd system_app_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow installd app_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	READS: 
		allow appdomain app_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow -isolated_app app_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow init -app_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow installd system_app_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow installd app_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	NEVERALLOWS: 
		neverallow logd app_data_file:fifo_file write;
		neverallow netd app_data_file:fifo_file write;

adb_keys_file:file 
	WRITES: 
		allow system_server adb_keys_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow adbd adb_keys_file:file {#getattr#open#read#ioctl#lock#};
		allow system_server adb_keys_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

system_app_tmpfs:file 
	WRITES: 
		allow system_app system_app_tmpfs:file {#read#write#};
	READS: 
		allow system_app system_app_tmpfs:file execute;
		allow system_app system_app_tmpfs:file {#read#write#};
	NEVERALLOWS: 

gpsd_tmpfs:file 
	WRITES: 
		allow gpsd gpsd_tmpfs:file {#read#write#};
	READS: 
		allow gpsd gpsd_tmpfs:file {#read#write#};
	NEVERALLOWS: 

self:capability 
	WRITES: 
		allow bluetooth self:capability net_admin;
		allow dumpstate self:capability sys_ptrace;
		allow init self:capability net_admin;
		allow init self:capability sys_admin;
		allow ppp self:capability net_admin;
		allow sgdisk self:capability sys_admin;
		allow zygote self:capability sys_admin;
	READS: 
		allow dumpstate self:capability sys_ptrace;
	NEVERALLOWS: 
		neverallow appdomain self:capability *;
		neverallow -bluetooth self:capability *;
		neverallow bluetooth self:capability ~net_admin;
		neverallow domain self:capability sys_rawio;
		neverallow -kernel self:capability sys_rawio;
		neverallow -init self:capability sys_rawio;
		neverallow -recovery self:capability sys_rawio;
		neverallow -ueventd self:capability sys_rawio;
		neverallow -watchdogd self:capability sys_rawio;
		neverallow -healthd self:capability sys_rawio;
		neverallow -vold self:capability sys_rawio;
		neverallow -uncrypt self:capability sys_rawio;
		neverallow -tee self:capability sys_rawio;
		neverallow gpsd self:capability *;
		neverallow runas self:capability ~{#setuid#setgid#};

init:key 
	WRITES: 
		allow init init:key {#write#search#setattr#};
		allow vold init:key {#write#search#setattr#};
	READS: 
		allow domain init:key search;
		allow init init:key {#write#search#setattr#};
		allow vold init:key {#write#search#setattr#};
	NEVERALLOWS: 

system_server:tcp_socket 
	WRITES: 
		allow appdomain system_server:tcp_socket {#read#write#getattr#getopt#shutdown#};
	READS: 
		allow appdomain system_server:tcp_socket {#read#write#getattr#getopt#shutdown#};
	NEVERALLOWS: 

sysfs:file 
	WRITES: 
		allow dumpstate sysfs:file {#open#append#write#};
		allow gpsd sysfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow healthd sysfs:file write;
		allow mediaserver sysfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow netd sysfs:file write;
		allow nfc sysfs:file write;
		allow system_server sysfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow ueventd sysfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold sysfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain sysfs:file {#getattr#open#read#ioctl#lock#};
		allow gpsd sysfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init sysfs:file {#getattr#relabelfrom#};
		allow mediaserver sysfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server sysfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow ueventd sysfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold sysfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

-sdcard_type:dir 
	WRITES: 
		allow init -sdcard_type:dir {#open#read#setattr#search#};
	READS: 
		allow init -sdcard_type:dir {#open#read#setattr#search#};
	NEVERALLOWS: 

sysfs_nfc_power_writable:file 
	WRITES: 
		allow nfc sysfs_nfc_power_writable:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server sysfs_nfc_power_writable:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow nfc sysfs_nfc_power_writable:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server sysfs_nfc_power_writable:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

block_device:dir 
	WRITES: 
		allow vold block_device:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow blkid block_device:dir search;
		allow blkid_untrusted block_device:dir search;
		allow fsck block_device:dir search;
		allow fsck_untrusted block_device:dir search;
		allow install_recovery block_device:dir search;
		allow sgdisk block_device:dir search;
		allow system_server block_device:dir search;
		allow toolbox block_device:dir search;
		allow uncrypt block_device:dir {#open#getattr#read#search#ioctl#};
		allow vold block_device:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

sysfs_type:dir 
	WRITES: 
		allow init sysfs_type:dir relabelto;
		allow ueventd sysfs_type:dir {#relabelfrom#relabelto#setattr#{#open#getattr#read#search#ioctl#}#};
	READS: 
		allow init sysfs_type:dir {#open#getattr#read#search#ioctl#};
		allow ueventd sysfs_type:dir {#relabelfrom#relabelto#setattr#{#open#getattr#read#search#ioctl#}#};
	NEVERALLOWS: 

system_server:fifo_file 
	WRITES: 
		allow appdomain system_server:fifo_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow appdomain system_server:fifo_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver system_server:fifo_file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

gps_control:file 
	WRITES: 
		allow system_server gps_control:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow system_server gps_control:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

random_device:chr_file 
	WRITES: 
		allow domain random_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain urandom_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain random_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain urandom_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init hw_random_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow system_server hw_random_device:chr_file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 
		neverallow domain hw_random_device:chr_file *;
		neverallow -init hw_random_device:chr_file *;
		neverallow -system_server hw_random_device:chr_file *;
		neverallow -ueventd hw_random_device:chr_file *;

shell:fd 
	WRITES: 
		allow runas shell:fd use;
		allow surfaceflinger shell:fd use;
	READS: 
		allow runas shell:fd use;
		allow surfaceflinger shell:fd use;
	NEVERALLOWS: 

dev_type:lnk_file 
	WRITES: 
		allow init dev_type:lnk_file create;
		allow ueventd dev_type:lnk_file {#create#unlink#};
	READS: 
		allow domain dev_type:lnk_file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 
		neverallow domain dev_type:lnk_file mounton;

bluetooth_data_file:sock_file 
	WRITES: 
		allow bluetooth bluetooth_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow installd bluetooth_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	READS: 
		allow bluetooth bluetooth_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow installd bluetooth_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	NEVERALLOWS: 

anr_data_file:file 
	WRITES: 
		allow appdomain anr_data_file:file {#open#append#};
		allow dumpstate anr_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_app anr_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server anr_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow adbd anr_data_file:file {#getattr#open#read#ioctl#lock#};
		allow dumpstate anr_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow shell anr_data_file:file {#getattr#open#read#ioctl#lock#};
		allow system_app anr_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server anr_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow untrusted_app anr_data_file:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

racoon:process 
	WRITES: 
		allow init racoon:process transition;
	READS: 
		allow servicemanager racoon:process getattr;
	NEVERALLOWS: 

-shell_data_file:lnk_file 
	WRITES: 
		allow init -shell_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	READS: 
		allow init -shell_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

bootanim_tmpfs:file 
	WRITES: 
		allow bootanim bootanim_tmpfs:file {#read#write#};
	READS: 
		allow bootanim bootanim_tmpfs:file {#read#write#};
	NEVERALLOWS: 

gps_data_file:fifo_file 
	WRITES: 
		allow gpsd gps_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow gpsd gps_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

{file_type:sock_file 
	WRITES: 
		allow init {file_type:sock_file relabelto;
		allow init {file_type:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init {file_type:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

properties_device:file 
	WRITES: 
		allow init properties_device:file relabelto;
	READS: 
		allow domain properties_device:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

dalvikcache_data_file:lnk_file 
	WRITES: 
		allow zygote dalvikcache_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain dalvikcache_data_file:lnk_file {#getattr#open#read#ioctl#lock#};
		allow dex2oat dalvikcache_data_file:lnk_file read;
		allow dumpstate dalvikcache_data_file:lnk_file {#getattr#open#read#ioctl#lock#};
		allow zygote dalvikcache_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

tee_data_file:dir 
	WRITES: 
		allow tee tee_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow tee tee_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	NEVERALLOWS: 

keystore_tmpfs:file 
	WRITES: 
		allow keystore keystore_tmpfs:file {#read#write#};
	READS: 
		allow keystore keystore_tmpfs:file {#read#write#};
	NEVERALLOWS: 

fs_type:dir 
	WRITES: 
		allow init fs_type:dir {#open#read#setattr#search#};
		allow init sysfs_type:dir relabelto;
		allow ueventd sysfs_type:dir {#relabelfrom#relabelto#setattr#{#open#getattr#read#search#ioctl#}#};
	READS: 
		allow domain fs_type:dir getattr;
		allow init fs_type:dir {#open#read#setattr#search#};
		allow init sysfs_type:dir {#open#getattr#read#search#ioctl#};
		allow ueventd sysfs_type:dir {#relabelfrom#relabelto#setattr#{#open#getattr#read#search#ioctl#}#};
	NEVERALLOWS: 

zoneinfo_data_file:dir 
	WRITES: 
		allow system_server zoneinfo_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow tzdatacheck zoneinfo_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow domain zoneinfo_data_file:dir {#open#getattr#read#search#ioctl#};
		allow system_server zoneinfo_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow tzdatacheck zoneinfo_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

init_exec:file 
	WRITES: 
		allow kernel init_exec:file relabelto;
	READS: 
		allow init init_exec:file {#entrypoint#open#read#execute#getattr#};
		allow init init_exec:file {#getattr#open#read#execute#};
		allow kernel init_exec:file {#getattr#open#read#execute#};
		allow ueventd init_exec:file {#entrypoint#open#read#execute#getattr#};
		allow watchdogd init_exec:file {#entrypoint#open#read#execute#getattr#};
	NEVERALLOWS: 
		neverallow init -init_exec:file entrypoint;

system_app_data_file:fifo_file 
	WRITES: 
		allow installd system_app_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	READS: 
		allow installd system_app_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	NEVERALLOWS: 

radio_data_file:fifo_file 
	WRITES: 
		allow installd radio_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow radio radio_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow installd radio_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow radio radio_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

netd:fd 
	WRITES: 
		allow clatd netd:fd use;
		allow dhcp netd:fd use;
		allow dnsmasq netd:fd use;
		allow hostapd netd:fd use;
	READS: 
		allow clatd netd:fd use;
		allow dhcp netd:fd use;
		allow dnsmasq netd:fd use;
		allow hostapd netd:fd use;
	NEVERALLOWS: 

self:unix_dgram_socket 
	WRITES: 
		allow domain self:unix_dgram_socket {#{#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#}#sendto#};
	READS: 
		allow domain self:unix_dgram_socket {#{#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#}#sendto#};
	NEVERALLOWS: 

system_server:process 
	WRITES: 
		allow dumpstate system_server:process signal;
		allow zygote system_server:process dyntransition;
		allow zygote system_server:process {#getpgid#setpgid#};
	READS: 
		allow servicemanager system_server:process getattr;
		allow zygote system_server:process {#getpgid#setpgid#};
	NEVERALLOWS: 

nfc_data_file:dir 
	WRITES: 
		allow installd nfc_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow nfc nfc_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow installd nfc_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow nfc nfc_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server nfc_data_file:dir {#getattr#read#search#};
	NEVERALLOWS: 

input_device:chr_file 
	WRITES: 
		allow inputflinger input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow healthd input_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow inputflinger input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow input_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow system_server input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

dhcp_data_file:dir 
	WRITES: 
		allow dhcp dhcp_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow dnsmasq dhcp_data_file:dir {#open#search#write#add_name#remove_name#};
	READS: 
		allow dhcp dhcp_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow dnsmasq dhcp_data_file:dir {#open#search#write#add_name#remove_name#};
	NEVERALLOWS: 

system_data_file:sock_file 
	WRITES: 
		allow installd system_data_file:sock_file {#getattr#relabelfrom#unlink#};
		allow system_server system_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow installd system_data_file:sock_file {#getattr#relabelfrom#unlink#};
		allow system_server system_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 
		neverallow logd system_data_file:sock_file write;
		neverallow netd system_data_file:sock_file write;

adbd_socket:sock_file 
	WRITES: 
		allow system_server adbd_socket:sock_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow system_server adbd_socket:sock_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow appdomain adbd_socket:sock_file write;

property_data_file:file 
	WRITES: 
		allow init property_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow init property_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 
		neverallow domain property_data_file:file {#append#create#link#unlink#relabelfrom#rename#setattr#write#};
		neverallow -init property_data_file:file {#append#create#link#unlink#relabelfrom#rename#setattr#write#};

mnt_media_rw_file:dir 
	WRITES: 
		allow vold mnt_media_rw_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow platform_app mnt_media_rw_file:dir {#open#getattr#read#search#ioctl#};
		allow sdcardd mnt_media_rw_file:dir {#open#getattr#read#search#ioctl#};
		allow system_app mnt_media_rw_file:dir search;
		allow untrusted_app mnt_media_rw_file:dir search;
		allow vold mnt_media_rw_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

sysfs:dir 
	WRITES: 
		allow init sysfs:dir mounton;
	READS: 
		allow domain sysfs:dir {#open#getattr#read#search#ioctl#};
		allow init sysfs:dir {#getattr#relabelfrom#};
		allow init sysfs:dir mounton;
	NEVERALLOWS: 

mnt_expand_file:dir 
	WRITES: 
		allow vold mnt_expand_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#mounton#};
	READS: 
		allow appdomain mnt_expand_file:dir {#open#getattr#read#search#ioctl#};
		allow installd mnt_expand_file:dir {#search#getattr#};
		allow sdcardd mnt_expand_file:dir search;
		allow system_server mnt_expand_file:dir {#open#getattr#read#search#ioctl#};
		allow vold mnt_expand_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#mounton#};
	NEVERALLOWS: 

self:packet_socket 
	WRITES: 
		allow clatd self:packet_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow dhcp self:packet_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow hostapd self:packet_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow system_server self:packet_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow wpa self:packet_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	READS: 
		allow clatd self:packet_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow dhcp self:packet_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow hostapd self:packet_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow system_server self:packet_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow wpa self:packet_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	NEVERALLOWS: 

asec_apk_file:dir 
	WRITES: 
		allow platform_app asec_apk_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server asec_apk_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold asec_apk_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#mounton#relabelfrom#relabelto#};
	READS: 
		allow domain asec_apk_file:dir {#open#getattr#read#search#ioctl#};
		allow platform_app asec_apk_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server asec_apk_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold asec_apk_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#mounton#relabelfrom#relabelto#};
	NEVERALLOWS: 

nfc_data_file:file 
	WRITES: 
		allow installd nfc_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow nfc nfc_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server nfc_data_file:file {#getattr#read#write#};
	READS: 
		allow installd nfc_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow nfc nfc_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server nfc_data_file:file {#getattr#read#write#};
	NEVERALLOWS: 

frp_block_device:blk_file 
	WRITES: 
		allow system_server frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow system_server frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow domain frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		neverallow -init frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		neverallow -recovery frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		neverallow -system_server frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};

-keystore_data_file:sock_file 
	WRITES: 
		allow init -keystore_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -keystore_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

asec_public_file:dir 
	WRITES: 
		allow vold asec_public_file:dir {#relabelto#setattr#};
	READS: 
		allow domain asec_public_file:dir {#open#getattr#read#search#ioctl#};
	NEVERALLOWS: 

security_file:dir 
	WRITES: 
		allow init -security_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
		allow init security_file:dir {#create#setattr#};
		allow system_server security_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow debuggerd security_file:dir {#open#getattr#read#search#ioctl#};
		allow domain security_file:dir {#search#getattr#};
		allow init -security_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
		allow init security_file:dir {#open#getattr#read#search#ioctl#};
		allow installd security_file:dir {#open#getattr#read#search#ioctl#};
		allow runas security_file:dir {#open#getattr#read#search#ioctl#};
		allow system_server security_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server security_file:dir {#open#getattr#read#search#ioctl#};
		allow ueventd security_file:dir {#open#getattr#read#search#ioctl#};
		allow vold security_file:dir {#open#getattr#read#search#ioctl#};
		allow zygote security_file:dir {#open#getattr#read#search#ioctl#};
	NEVERALLOWS: 
		neverallow domain security_file:dir {#relabelfrom#relabelto#};
		neverallow -init security_file:dir {#relabelfrom#relabelto#};
		neverallow domain security_file:dir {#create#setattr#};
		neverallow -init security_file:dir {#create#setattr#};
		neverallow -system_server security_file:dir {#create#setattr#};
		neverallow domain security_file:dir {#rename#write#add_name#remove_name#rmdir#};
		neverallow -system_server security_file:dir {#rename#write#add_name#remove_name#rmdir#};

sysfs_devices_system_cpu:file 
	WRITES: 
		allow system_server sysfs_devices_system_cpu:file {#open#append#write#};
		allow ueventd sysfs_devices_system_cpu:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain sysfs_devices_system_cpu:file {#getattr#open#read#ioctl#lock#};
		allow ueventd sysfs_devices_system_cpu:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

recovery_block_device:blk_file 
	WRITES: 
		allow install_recovery recovery_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow install_recovery recovery_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow domain recovery_block_device:blk_file write;
		neverallow -install_recovery recovery_block_device:blk_file write;
		neverallow -recovery recovery_block_device:blk_file write;

isolated_app_tmpfs:file 
	WRITES: 
		allow isolated_app isolated_app_tmpfs:file {#read#write#};
	READS: 
		allow isolated_app isolated_app_tmpfs:file execute;
		allow isolated_app isolated_app_tmpfs:file {#read#write#};
	NEVERALLOWS: 

proc:file 
	WRITES: 
		allow appdomain qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init proc:file {#open#append#write#};
		allow mediaserver qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow appdomain qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain proc:file {#getattr#open#read#ioctl#lock#};
		allow dumpstate qtaguid_proc:file {#getattr#open#read#ioctl#lock#};
		allow mediaserver qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow domain proc:file mounton;
		neverallow -init proc:file mounton;

fs_type:file 
	WRITES: 
		allow init fs_type:file {#open#read#setattr#};
		allow init sysfs_type:file relabelto;
		allow init sysfs_type:file {#open#append#write#};
		allow ueventd sysfs_type:file {#relabelfrom#relabelto#setattr#getattr#};
	READS: 
		allow init fs_type:file {#open#read#setattr#};
		allow ueventd sysfs_type:file {#relabelfrom#relabelto#setattr#getattr#};
	NEVERALLOWS: 
		neverallow blkid fs_type:file entrypoint;
		neverallow blkid_untrusted fs_type:file entrypoint;
		neverallow fsck fs_type:file entrypoint;
		neverallow fsck_untrusted fs_type:file entrypoint;
		neverallow init fs_type:file execute_no_trans;
		neverallow init fs_type:file entrypoint;
		neverallow kernel fs_type:file {#entrypoint#execute_no_trans#};

-rootfs:dir 
	WRITES: 
		allow init -rootfs:dir {#open#read#setattr#search#};
	READS: 
		allow init -rootfs:dir {#open#read#setattr#search#};
	NEVERALLOWS: 

zygote:unix_stream_socket 
	WRITES: 
		allow system_server zygote:unix_stream_socket connectto;
	READS: 
		allow system_server zygote:unix_stream_socket {#getopt#getattr#};
	NEVERALLOWS: 
		neverallow domain zygote:unix_stream_socket connectto;
		neverallow -zygote zygote:unix_stream_socket connectto;
		neverallow -system_server zygote:unix_stream_socket connectto;

storage_stub_file:dir 
	WRITES: 
		allow sdcardd storage_stub_file:dir {#search#mounton#};
		allow vold storage_stub_file:dir {#mounton#create#rmdir#getattr#setattr#};
	READS: 
		allow sdcardd storage_stub_file:dir {#search#mounton#};
		allow vold storage_stub_file:dir {#mounton#create#rmdir#getattr#setattr#};
	NEVERALLOWS: 

-system_file:sock_file 
	WRITES: 
		allow init -system_file:sock_file relabelto;
		allow init -system_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -system_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

resourcecache_data_file:file 
	WRITES: 
		allow installd resourcecache_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow zygote resourcecache_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain resourcecache_data_file:file {#getattr#open#read#ioctl#lock#};
		allow installd resourcecache_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server resourcecache_data_file:file {#getattr#open#read#ioctl#lock#};
		allow zygote resourcecache_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

self:socket 
	WRITES: 
		allow bluetoothdomain self:socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow mtp self:socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow rild self:socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	READS: 
		allow bluetoothdomain self:socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow mtp self:socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow rild self:socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	NEVERALLOWS: 

appdomain:fifo_file 
	WRITES: 
		allow appdomain appdomain:fifo_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow binderservicedomain appdomain:fifo_file write;
		allow mediaserver appdomain:fifo_file {#getattr#read#write#};
		allow system_server appdomain:fifo_file {#getattr#read#write#};
	READS: 
		allow appdomain appdomain:fifo_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver appdomain:fifo_file {#getattr#read#write#};
		allow system_server appdomain:fifo_file {#getattr#read#write#};
	NEVERALLOWS: 

-security_file:file 
	WRITES: 
		allow init -security_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	READS: 
		allow init -security_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

apk_private_data_file:file 
	WRITES: 
		allow system_server apk_private_data_file:file {#relabelfrom#relabelto#};
		allow system_server apk_private_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow system_server apk_private_data_file:file {#relabelfrom#relabelto#};
		allow system_server apk_private_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

netd:fifo_file 
	WRITES: 
		allow clatd netd:fifo_file {#read#write#};
		allow dhcp netd:fifo_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow dnsmasq netd:fifo_file {#read#write#};
		allow hostapd netd:fifo_file {#read#write#};
	READS: 
		allow clatd netd:fifo_file {#read#write#};
		allow dhcp netd:fifo_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow dnsmasq netd:fifo_file {#read#write#};
		allow hostapd netd:fifo_file {#read#write#};
	NEVERALLOWS: 

apk_private_tmp_file:dir 
	WRITES: 
		allow platform_app apk_private_tmp_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server apk_private_tmp_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server apk_private_tmp_file:dir {#relabelfrom#relabelto#};
	READS: 
		allow platform_app apk_private_tmp_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server apk_private_tmp_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server apk_private_tmp_file:dir {#relabelfrom#relabelto#};
		allow untrusted_app apk_private_tmp_file:dir {#open#getattr#read#search#ioctl#};
	NEVERALLOWS: 

mediaserver_tmpfs:file 
	WRITES: 
		allow mediaserver mediaserver_tmpfs:file {#read#write#};
	READS: 
		allow mediaserver mediaserver_tmpfs:file {#read#write#};
	NEVERALLOWS: 

ptmx_device:chr_file 
	WRITES: 
		allow domain ptmx_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain ptmx_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

media_rw_data_file:dir 
	WRITES: 
		allow installd media_rw_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow installd media_rw_data_file:dir relabelto;
		allow platform_app media_rw_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow sdcardd media_rw_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow untrusted_app media_rw_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold media_rw_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow drmserver media_rw_data_file:dir {#open#getattr#read#search#ioctl#};
		allow installd media_rw_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow mediaserver media_rw_data_file:dir {#open#getattr#read#search#ioctl#};
		allow platform_app media_rw_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow sdcardd media_rw_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow untrusted_app media_rw_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold media_rw_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

functionfs:file 
	WRITES: 
		allow adbd functionfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow adbd functionfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

-app_data_file:dir 
	WRITES: 
		allow init -app_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	READS: 
		allow init -app_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	NEVERALLOWS: 

bluetooth_data_file:dir 
	WRITES: 
		allow bluetooth bluetooth_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow installd bluetooth_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
	READS: 
		allow bluetooth bluetooth_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow installd bluetooth_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow system_server bluetooth_data_file:dir {#getattr#read#search#};
	NEVERALLOWS: 

drm_data_file:file 
	WRITES: 
		allow drmserver drm_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow drmserver drm_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

self:tcp_socket 
	WRITES: 
		allow netdomain self:tcp_socket {#create#{#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#listen#accept#}#};
	READS: 
		allow netdomain self:tcp_socket {#create#{#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#listen#accept#}#};
	NEVERALLOWS: 

misc_logd_file:file 
	WRITES: 
		allow logd misc_logd_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow logd misc_logd_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow shell misc_logd_file:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

installd:fd 
	WRITES: 
		allow dex2oat installd:fd use;
	READS: 
		allow dex2oat installd:fd use;
	NEVERALLOWS: 

system_wpa_socket:sock_file 
	WRITES: 
		allow system_server system_wpa_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow wpa system_wpa_socket:sock_file write;
	READS: 
		allow system_server system_wpa_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

system_server_tmpfs:file 
	WRITES: 
		allow system_server system_server_tmpfs:file {#read#write#};
	READS: 
		allow system_server system_server_tmpfs:file execute;
		allow system_server system_server_tmpfs:file {#read#write#};
	NEVERALLOWS: 

usb_device:chr_file 
	WRITES: 
		allow appdomain usb_device:chr_file {#read#write#getattr#ioctl#};
		allow system_server usb_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow appdomain usb_device:chr_file {#read#write#getattr#ioctl#};
		allow system_server usb_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

tun_device:chr_file 
	WRITES: 
		allow bluetooth tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow clatd tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow untrusted_app tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow bluetooth tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow clatd tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow racoon tun_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow system_server tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow untrusted_app tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

systemkeys_data_file:file 
	WRITES: 
		allow system_server systemkeys_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow system_server systemkeys_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

gps_data_file:lnk_file 
	WRITES: 
		allow gpsd gps_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow gpsd gps_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

-app_data_file:lnk_file 
	WRITES: 
		allow init -app_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	READS: 
		allow init -app_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

sysfs_type:lnk_file 
	WRITES: 
		allow init sysfs_type:lnk_file relabelto;
		allow ueventd sysfs_type:lnk_file {#relabelfrom#relabelto#setattr#getattr#};
	READS: 
		allow ueventd sysfs_type:lnk_file {#relabelfrom#relabelto#setattr#getattr#};
	NEVERALLOWS: 

gatekeeperd:fd 
	WRITES: 
		allow system_server gatekeeperd:fd use;
	READS: 
		allow system_server gatekeeperd:fd use;
	NEVERALLOWS: 

healthd:fd 
	WRITES: 
		allow vold healthd:fd use;
	READS: 
		allow vold healthd:fd use;
	NEVERALLOWS: 

-vold_data_file}:sock_file 
	WRITES: 
		allow init -vold_data_file}:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -vold_data_file}:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

netd:unix_dgram_socket 
	WRITES: 
		allow clatd netd:unix_dgram_socket {#read#write#};
		allow dhcp netd:unix_dgram_socket {#read#write#};
		allow dnsmasq netd:unix_dgram_socket {#read#write#};
		allow hostapd netd:unix_dgram_socket {#read#write#};
	READS: 
		allow clatd netd:unix_dgram_socket {#read#write#};
		allow dhcp netd:unix_dgram_socket {#read#write#};
		allow dnsmasq netd:unix_dgram_socket {#read#write#};
		allow hostapd netd:unix_dgram_socket {#read#write#};
	NEVERALLOWS: 

qtaguid_device:chr_file 
	WRITES: 
		allow system_server qtaguid_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow appdomain qtaguid_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow mediaserver qtaguid_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow system_server qtaguid_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

nfc_tmpfs:file 
	WRITES: 
		allow nfc nfc_tmpfs:file {#read#write#};
	READS: 
		allow nfc nfc_tmpfs:file execute;
		allow nfc nfc_tmpfs:file {#read#write#};
	NEVERALLOWS: 

appdomain:file 
	WRITES: 
		allow lmkd appdomain:file write;
	READS: 
		allow lmkd appdomain:file {#getattr#open#read#ioctl#lock#};
		allow servicemanager appdomain:file {#read#open#};
		allow surfaceflinger appdomain:file {#getattr#open#read#ioctl#lock#};
		allow zygote appdomain:file {#{#getattr#open#read#ioctl#lock#}#};
	NEVERALLOWS: 
		neverallow appdomain -appdomain:file write;

nfc_device:chr_file 
	WRITES: 
		allow nfc nfc_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow nfc nfc_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

cpuctl_device:dir 
	WRITES: 
		allow init cpuctl_device:dir {#create#mounton#};
	READS: 
		allow init cpuctl_device:dir {#create#mounton#};
	NEVERALLOWS: 

surfaceflinger:unix_stream_socket 
	WRITES: 
		allow appdomain surfaceflinger:unix_stream_socket {#read#write#setopt#getattr#getopt#shutdown#};
		allow system_server surfaceflinger:unix_stream_socket {#read#write#setopt#};
	READS: 
		allow appdomain surfaceflinger:unix_stream_socket {#read#write#setopt#getattr#getopt#shutdown#};
		allow system_server surfaceflinger:unix_stream_socket {#read#write#setopt#};
	NEVERALLOWS: 

su:fd 
	WRITES: 
		allow domain su:fd use;
		allow -init su:fd use;
	READS: 
		allow domain su:fd use;
		allow -init su:fd use;
	NEVERALLOWS: 

shell:fifo_file 
	WRITES: 
		allow runas shell:fifo_file {#read#write#};
	READS: 
		allow runas shell:fifo_file {#read#write#};
	NEVERALLOWS: 

owntty_device:chr_file 
	WRITES: 
		allow domain owntty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain owntty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

dalvikcache_profiles_data_file:dir 
	WRITES: 
		allow installd dalvikcache_profiles_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server dalvikcache_profiles_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow appdomain dalvikcache_profiles_data_file:dir {#search#getattr#};
		allow installd dalvikcache_profiles_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server dalvikcache_profiles_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	NEVERALLOWS: 

mnt_user_file:dir 
	WRITES: 
		allow vold mnt_user_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow zygote mnt_user_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow adbd mnt_user_file:dir {#open#getattr#read#search#ioctl#};
		allow appdomain mnt_user_file:dir {#open#getattr#read#search#ioctl#};
		allow system_server mnt_user_file:dir {#getattr#search#};
		allow vold mnt_user_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow zygote mnt_user_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

keystore:process 
	WRITES: 
		allow debuggerd -keystore:process {#ptrace#getattr#};
		allow init keystore:process transition;
	READS: 
		allow debuggerd -keystore:process {#ptrace#getattr#};
		allow servicemanager keystore:process getattr;
	NEVERALLOWS: 
		neverallow domain keystore:process ptrace;

bluetooth_data_file:lnk_file 
	WRITES: 
		allow bluetooth bluetooth_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow installd bluetooth_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	READS: 
		allow bluetooth bluetooth_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow installd bluetooth_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	NEVERALLOWS: 

wallpaper_file:file 
	WRITES: 
		allow appdomain wallpaper_file:file {#getattr#read#write#};
		allow system_server wallpaper_file:file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#unlink#};
		allow system_server wallpaper_file:file relabelto;
	READS: 
		allow appdomain wallpaper_file:file {#getattr#read#write#};
		allow system_app wallpaper_file:file {#getattr#open#read#ioctl#lock#};
		allow system_server wallpaper_file:file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#unlink#};
	NEVERALLOWS: 

audio_device:chr_file 
	WRITES: 
		allow bootanim audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow bootanim audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

keystore_data_file:file 
	WRITES: 
		allow init -keystore_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
		allow keystore keystore_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow init -keystore_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
		allow init keystore_data_file:file {#getattr#};
		allow keystore keystore_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 
		neverallow domain keystore_data_file:file *;
		neverallow -keystore keystore_data_file:file *;
		neverallow -init keystore_data_file:file *;
		neverallow domain keystore_data_file:file ~{#relabelto#getattr#};
		neverallow -keystore keystore_data_file:file ~{#relabelto#getattr#};

vdc_tmpfs:file 
	WRITES: 
		allow vdc vdc_tmpfs:file {#read#write#};
	READS: 
		allow vdc vdc_tmpfs:file {#read#write#};
	NEVERALLOWS: 

kmsg_device:chr_file 
	WRITES: 
		allow healthd kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow logd kmsg_device:chr_file {#open#append#write#};
		allow slideshow kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow watchdogd kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow healthd kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow watchdogd kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

mnt_media_rw_file:file 
	WRITES: 
		allow vold mnt_media_rw_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow vold mnt_media_rw_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

hci_attach_dev:chr_file 
	WRITES: 
		allow bluetooth hci_attach_dev:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow hci_attach hci_attach_dev:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow bluetooth hci_attach_dev:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow hci_attach hci_attach_dev:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

adb_device:chr_file 
	WRITES: 
		allow adbd adb_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow adbd adb_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

-system_file:fifo_file 
	WRITES: 
		allow init -system_file:fifo_file relabelto;
		allow init -system_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -system_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

keystore_data_file:sock_file 
	WRITES: 
		allow init -keystore_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow keystore keystore_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow init -keystore_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow keystore keystore_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 
		neverallow domain keystore_data_file:sock_file *;
		neverallow -keystore keystore_data_file:sock_file *;
		neverallow -init keystore_data_file:sock_file *;
		neverallow domain keystore_data_file:sock_file ~{#relabelto#getattr#};
		neverallow -keystore keystore_data_file:sock_file ~{#relabelto#getattr#};

-keystore_data_file:dir 
	WRITES: 
		allow init -keystore_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	READS: 
		allow init -keystore_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	NEVERALLOWS: 

nfc_data_file:lnk_file 
	WRITES: 
		allow installd nfc_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow nfc nfc_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow installd nfc_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow nfc nfc_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

{file_type:file 
	WRITES: 
		allow init {file_type:file relabelto;
		allow init {file_type:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	READS: 
		allow init {file_type:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

self:netlink_route_socket 
	WRITES: 
		allow clatd self:netlink_route_socket nlmsg_write;
		allow dhcp self:netlink_route_socket nlmsg_write;
		allow hostapd self:netlink_route_socket nlmsg_write;
		allow netdomain self:netlink_route_socket {#{#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#}#nlmsg_read#};
		allow netd self:netlink_route_socket nlmsg_write;
		allow rild self:netlink_route_socket nlmsg_write;
		allow system_server self:netlink_route_socket nlmsg_write;
		allow wpa self:netlink_route_socket nlmsg_write;
	READS: 
		allow netdomain self:netlink_route_socket {#{#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#}#nlmsg_read#};
	NEVERALLOWS: 

radio_device:chr_file 
	WRITES: 
		allow rild radio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow rild radio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server radio_device:chr_file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

dumpstate_tmpfs:file 
	WRITES: 
		allow dumpstate dumpstate_tmpfs:file {#read#write#};
	READS: 
		allow dumpstate dumpstate_tmpfs:file execute;
		allow dumpstate dumpstate_tmpfs:file {#read#write#};
	NEVERALLOWS: 

fingerprintd_tmpfs:file 
	WRITES: 
		allow fingerprintd fingerprintd_tmpfs:file {#read#write#};
	READS: 
		allow fingerprintd fingerprintd_tmpfs:file {#read#write#};
	NEVERALLOWS: 

mtp:fd 
	WRITES: 
		allow ppp mtp:fd use;
	READS: 
		allow ppp mtp:fd use;
	NEVERALLOWS: 

media_rw_data_file:file 
	WRITES: 
		allow installd media_rw_data_file:file {#getattr#unlink#};
		allow platform_app media_rw_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow sdcardd media_rw_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server media_rw_data_file:file {#getattr#read#write#};
		allow untrusted_app media_rw_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow vold media_rw_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain media_rw_data_file:file {#read#getattr#};
		allow drmserver media_rw_data_file:file {#getattr#open#read#ioctl#lock#};
		allow installd media_rw_data_file:file {#getattr#unlink#};
		allow mediaserver media_rw_data_file:file {#getattr#open#read#ioctl#lock#};
		allow platform_app media_rw_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow sdcardd media_rw_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server media_rw_data_file:file {#getattr#read#write#};
		allow untrusted_app media_rw_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow vold media_rw_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

netd_tmpfs:file 
	WRITES: 
		allow netd netd_tmpfs:file {#read#write#};
	READS: 
		allow netd netd_tmpfs:file {#read#write#};
	NEVERALLOWS: 

self:tun_socket 
	WRITES: 
		allow bluetooth self:tun_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow clatd self:tun_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow racoon self:tun_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow system_server self:tun_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	READS: 
		allow bluetooth self:tun_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow clatd self:tun_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow racoon self:tun_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow system_server self:tun_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	NEVERALLOWS: 

netdomain:fd 
	WRITES: 
		allow netd netdomain:fd use;
	READS: 
		allow netd netdomain:fd use;
	NEVERALLOWS: 

vold_device:blk_file 
	WRITES: 
		allow fsck_untrusted vold_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow sgdisk vold_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold vold_device:blk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow blkid_untrusted vold_device:blk_file {#getattr#open#read#ioctl#lock#};
		allow fsck_untrusted vold_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow sgdisk vold_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold vold_device:blk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

sysfs_writable:file 
	WRITES: 
		allow domain sysfs_writable:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain sysfs_writable:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

bluetooth_tmpfs:file 
	WRITES: 
		allow bluetooth bluetooth_tmpfs:file {#read#write#};
	READS: 
		allow bluetooth bluetooth_tmpfs:file execute;
		allow bluetooth bluetooth_tmpfs:file {#read#write#};
	NEVERALLOWS: 

-system_file:file 
	WRITES: 
		allow init -system_file:file relabelto;
		allow init -system_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	READS: 
		allow init -system_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

system_app_data_file:file 
	WRITES: 
		allow installd system_app_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow system_app system_app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server system_app_data_file:file {#getattr#read#write#};
		allow system_server system_app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow untrusted_app system_app_data_file:file {#read#write#getattr#};
	READS: 
		allow installd system_app_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow system_app system_app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server system_app_data_file:file {#getattr#read#write#};
		allow system_server system_app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow untrusted_app system_app_data_file:file {#read#write#getattr#};
	NEVERALLOWS: 

vold_data_file:file 
	WRITES: 
		allow vold vold_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow init vold_data_file:file {#getattr#};
		allow vold vold_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

platform_app_tmpfs:file 
	WRITES: 
		allow platform_app platform_app_tmpfs:file {#read#write#};
	READS: 
		allow platform_app platform_app_tmpfs:file execute;
		allow platform_app platform_app_tmpfs:file {#read#write#};
	NEVERALLOWS: 

unlabeled:file 
	WRITES: 
		allow init unlabeled:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#};
		allow installd unlabeled:file {#getattr#relabelfrom#rename#unlink#setattr#};
		allow vold unlabeled:file {#{#getattr#open#read#ioctl#lock#}#setattr#relabelfrom#};
	READS: 
		allow dex2oat unlabeled:file read;
		allow init unlabeled:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#};
		allow installd unlabeled:file {#getattr#open#read#ioctl#lock#};
		allow installd unlabeled:file {#getattr#relabelfrom#rename#unlink#setattr#};
		allow system_server unlabeled:file {#getattr#open#read#ioctl#lock#};
		allow vold unlabeled:file {#{#getattr#open#read#ioctl#lock#}#setattr#relabelfrom#};
	NEVERALLOWS: 
		neverallow domain unlabeled:file create;
		neverallow -init unlabeled:file create;
		neverallow -recovery unlabeled:file create;

selinuxfs:file 
	WRITES: 
		allow appdomain selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow debuggerd selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow drmserver selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow installd selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow kernel selinuxfs:file write;
		allow keystore selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow runas selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow servicemanager selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow zygote selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow appdomain selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow debuggerd selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain selinuxfs:file {#getattr#open#read#ioctl#lock#};
		allow drmserver selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow installd selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow keystore selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow runas selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow servicemanager selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow zygote selinuxfs:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

-app_data_file}:dir 
	WRITES: 
		allow init -app_data_file}:dir {#create#search#getattr#open#read#setattr#ioctl#};
	READS: 
		allow init -app_data_file}:dir {#create#search#getattr#open#read#setattr#ioctl#};
	NEVERALLOWS: 

shell_data_file:dir 
	WRITES: 
		allow adbd shell_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow dumpstate shell_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow init -shell_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
		allow init shell_data_file:dir {#open#create#read#getattr#setattr#search#};
		allow installd shell_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow shell shell_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold shell_data_file:dir {#create#getattr#setattr#};
	READS: 
		allow adbd shell_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow dumpstate shell_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow init -shell_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
		allow init shell_data_file:dir {#open#create#read#getattr#setattr#search#};
		allow installd shell_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow platform_app shell_data_file:dir search;
		allow shell shell_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server shell_data_file:dir {#getattr#read#search#};
		allow uncrypt shell_data_file:dir {#open#getattr#read#search#ioctl#};
		allow untrusted_app shell_data_file:dir {#open#getattr#read#search#ioctl#};
		allow vold shell_data_file:dir {#create#getattr#setattr#};
	NEVERALLOWS: 

proc_security:file 
	WRITES: 
		allow init proc_security:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow init proc_security:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow domain proc_security:file {#append#write#};
		neverallow -init proc_security:file {#append#write#};

self:key_socket 
	WRITES: 
		allow racoon self:key_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	READS: 
		allow racoon self:key_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	NEVERALLOWS: 

install_data_file:file 
	WRITES: 
		allow installd install_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow installd install_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow sdcardd install_data_file:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

video_device:chr_file 
	WRITES: 
		allow mediaserver video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow mediaserver video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

efs_file:dir 
	WRITES: 
		allow rild efs_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow bluetooth bluetooth_efs_file:dir {#open#getattr#read#search#ioctl#};
		allow bluetooth efs_file:dir search;
		allow drmserver efs_file:dir {#open#getattr#read#search#ioctl#};
		allow hci_attach bluetooth_efs_file:dir {#open#getattr#read#search#ioctl#};
		allow rild bluetooth_efs_file:dir {#open#getattr#read#search#ioctl#};
		allow rild efs_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow ueventd efs_file:dir search;
	NEVERALLOWS: 
		neverallow appdomain efs_file:dir write;
		neverallow appdomain efs_file:dir read;
		neverallow -shell efs_file:dir read;

system_app_data_file:dir 
	WRITES: 
		allow installd system_app_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow system_app system_app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server system_app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow installd system_app_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow system_app system_app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server system_app_data_file:dir {#getattr#read#search#};
		allow system_server system_app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

-security_file:dir 
	WRITES: 
		allow init -security_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	READS: 
		allow init -security_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	NEVERALLOWS: 

nfc_data_file:fifo_file 
	WRITES: 
		allow installd nfc_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow nfc nfc_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow installd nfc_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow nfc nfc_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

-vold_data_file}:fifo_file 
	WRITES: 
		allow init -vold_data_file}:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -vold_data_file}:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

self:netlink_selinux_socket 
	WRITES: 
		allow appdomain self:netlink_selinux_socket *;
		allow debuggerd self:netlink_selinux_socket *;
		allow drmserver self:netlink_selinux_socket *;
		allow init self:netlink_selinux_socket *;
		allow keystore self:netlink_selinux_socket *;
		allow servicemanager self:netlink_selinux_socket *;
		allow system_server self:netlink_selinux_socket *;
		allow zygote self:netlink_selinux_socket *;
	READS: 
		allow appdomain self:netlink_selinux_socket *;
		allow debuggerd self:netlink_selinux_socket *;
		allow drmserver self:netlink_selinux_socket *;
		allow init self:netlink_selinux_socket *;
		allow keystore self:netlink_selinux_socket *;
		allow servicemanager self:netlink_selinux_socket *;
		allow system_server self:netlink_selinux_socket *;
		allow zygote self:netlink_selinux_socket *;
	NEVERALLOWS: 

bluetooth_data_file:fifo_file 
	WRITES: 
		allow bluetooth bluetooth_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow installd bluetooth_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	READS: 
		allow bluetooth bluetooth_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow installd bluetooth_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	NEVERALLOWS: 

system_app_data_file:lnk_file 
	WRITES: 
		allow installd system_app_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow system_app system_app_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow installd system_app_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow system_app system_app_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

-security_file:fifo_file 
	WRITES: 
		allow init -security_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -security_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

security_file:file 
	WRITES: 
		allow init -security_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
		allow system_server security_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow debuggerd security_file:file {#getattr#open#read#ioctl#lock#};
		allow domain security_file:file getattr;
		allow init -security_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
		allow init security_file:file {#getattr#open#read#ioctl#lock#};
		allow installd security_file:file {#getattr#open#read#ioctl#lock#};
		allow runas security_file:file {#getattr#open#read#ioctl#lock#};
		allow system_server security_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server security_file:file {#getattr#open#read#ioctl#lock#};
		allow ueventd security_file:file {#getattr#open#read#ioctl#lock#};
		allow vold security_file:file {#getattr#open#read#ioctl#lock#};
		allow zygote security_file:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 
		neverallow domain security_file:file {#relabelfrom#relabelto#};
		neverallow -init security_file:file {#relabelfrom#relabelto#};
		neverallow domain security_file:file {#create#setattr#write#append#unlink#link#rename#};
		neverallow -system_server security_file:file {#create#setattr#write#append#unlink#link#rename#};

tty_device:chr_file 
	WRITES: 
		allow domain owntty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow healthd tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain owntty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow healthd tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

gps_socket:sock_file 
	WRITES: 
		allow gpsd gps_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server gps_socket:sock_file write;
	READS: 
		allow gpsd gps_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

shell_data_file:file 
	WRITES: 
		allow adbd shell_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow appdomain shell_data_file:file {#write#getattr#};
		allow binderservicedomain shell_data_file:file {#getattr#write#};
		allow dumpstate shell_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow init -shell_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
		allow installd shell_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow runas shell_data_file:file {#read#write#};
		allow shell shell_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server shell_data_file:file {#getattr#read#write#};
		allow vdc shell_data_file:file {#write#getattr#};
	READS: 
		allow adbd shell_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow appdomain shell_data_file:file {#write#getattr#};
		allow binderservicedomain shell_data_file:file {#getattr#write#};
		allow bluetooth shell_data_file:file read;
		allow dumpstate shell_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow init -shell_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
		allow init shell_data_file:file {#getattr#};
		allow installd shell_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow nfc shell_data_file:file read;
		allow platform_app shell_data_file:file {#open#getattr#read#};
		allow runas shell_data_file:file {#read#write#};
		allow shell shell_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow shell shell_data_file:file {#{#getattr#open#read#ioctl#lock#}#{#getattr#execute#execute_no_trans#}#};
		allow system_server shell_data_file:file {#getattr#read#write#};
		allow uncrypt shell_data_file:file {#getattr#open#read#ioctl#lock#};
		allow untrusted_app shell_data_file:file {#getattr#open#read#ioctl#lock#};
		allow vdc shell_data_file:file {#write#getattr#};
	NEVERALLOWS: 

mtp:socket 
	WRITES: 
		allow ppp mtp:socket {#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#};
	READS: 
		allow ppp mtp:socket {#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#};
	NEVERALLOWS: 

vold:key 
	WRITES: 
		allow vold vold:key {#write#search#setattr#};
	READS: 
		allow domain vold:key search;
		allow vold vold:key {#write#search#setattr#};
	NEVERALLOWS: 

block_device:blk_file 
	WRITES: 
		allow fsck cache_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow fsck userdata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init metadata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init swap_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow install_recovery recovery_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow toolbox swap_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow uncrypt block_device:blk_file {#open#append#write#};
		allow uncrypt userdata_block_device:blk_file {#open#append#write#};
		allow vold block_device:blk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow vold metadata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold userdata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow blkid userdata_block_device:blk_file {#getattr#open#read#ioctl#lock#};
		allow fsck cache_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow fsck userdata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init metadata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init swap_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow install_recovery boot_block_device:blk_file {#getattr#open#read#ioctl#lock#};
		allow install_recovery recovery_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow toolbox swap_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold block_device:blk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow vold metadata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold userdata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow domain frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		neverallow -init frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		neverallow -recovery frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		neverallow -system_server frp_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		neverallow domain recovery_block_device:blk_file write;
		neverallow -install_recovery recovery_block_device:blk_file write;
		neverallow -recovery recovery_block_device:blk_file write;
		neverallow domain block_device:blk_file {#open#read#write#};
		neverallow -kernel block_device:blk_file {#open#read#write#};
		neverallow -init block_device:blk_file {#open#read#write#};
		neverallow -recovery block_device:blk_file {#open#read#write#};
		neverallow -vold block_device:blk_file {#open#read#write#};
		neverallow -uncrypt block_device:blk_file {#open#read#write#};
		neverallow domain system_block_device:blk_file write;
		neverallow -recovery system_block_device:blk_file write;

system_data_file:fifo_file 
	WRITES: 
		allow installd system_data_file:fifo_file {#getattr#relabelfrom#unlink#};
		allow system_server system_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow installd system_data_file:fifo_file {#getattr#relabelfrom#unlink#};
		allow system_server system_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 
		neverallow logd system_data_file:fifo_file write;
		neverallow netd system_data_file:fifo_file write;

netdomain:{tcp_socket {read#write#getattr#setattr#getopt#setopt};
	WRITES: 
		allow netd netdomain:{tcp_socket {read#write#getattr#setattr#getopt#setopt};
	READS: 
		allow netd netdomain:{tcp_socket {read#write#getattr#setattr#getopt#setopt};
	NEVERALLOWS: 

surfaceflinger_tmpfs:file 
	WRITES: 
		allow surfaceflinger surfaceflinger_tmpfs:file {#read#write#};
	READS: 
		allow surfaceflinger surfaceflinger_tmpfs:file {#read#write#};
	NEVERALLOWS: 

asec_apk_file:file 
	WRITES: 
		allow platform_app asec_apk_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server asec_apk_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow vold asec_apk_file:file {#{#getattr#open#read#ioctl#lock#}#setattr#relabelfrom#relabelto#};
	READS: 
		allow dex2oat asec_apk_file:file read;
		allow drmserver asec_apk_file:file {#read#getattr#};
		allow installd asec_apk_file:file {#getattr#open#read#ioctl#lock#};
		allow mediaserver asec_apk_file:file {#read#getattr#};
		allow platform_app asec_apk_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_app asec_apk_file:file {#getattr#open#read#ioctl#lock#};
		allow system_server asec_apk_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow untrusted_app asec_apk_file:file {#getattr#open#read#ioctl#lock#};
		allow vold asec_apk_file:file {#{#getattr#open#read#ioctl#lock#}#setattr#relabelfrom#relabelto#};
	NEVERALLOWS: 

toolbox_tmpfs:file 
	WRITES: 
		allow toolbox toolbox_tmpfs:file {#read#write#};
	READS: 
		allow toolbox toolbox_tmpfs:file {#read#write#};
	NEVERALLOWS: 

inputflinger:process 
	WRITES: 
		allow init inputflinger:process transition;
	READS: 
		allow servicemanager inputflinger:process getattr;
	NEVERALLOWS: 

uhid_device:chr_file 
	WRITES: 
		allow bluetooth uhid_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow bluetooth uhid_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

apk_tmp_file:dir 
	WRITES: 
		allow installd apk_tmp_file:dir {#relabelfrom#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#};
		allow platform_app apk_tmp_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server apk_tmp_file:dir {#relabelfrom#relabelto#};
		allow system_server apk_tmp_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow installd apk_tmp_file:dir {#relabelfrom#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#};
		allow platform_app apk_tmp_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server apk_tmp_file:dir {#relabelfrom#relabelto#};
		allow system_server apk_tmp_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow untrusted_app apk_tmp_file:dir {#open#getattr#read#search#ioctl#};
	NEVERALLOWS: 

app_data_file:file 
	WRITES: 
		allow appdomain app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow -isolated_app app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow drmserver app_data_file:file {#read#write#getattr#};
		allow init -app_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
		allow installd system_app_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow installd app_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow isolated_app app_data_file:file {#read#write#getattr#lock#};
		allow mediaserver app_data_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger app_data_file:file {#read#write#};
		allow system_app system_app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server system_app_data_file:file {#getattr#read#write#};
		allow system_server app_data_file:file {#getattr#read#write#};
		allow system_server system_app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow untrusted_app system_app_data_file:file {#read#write#getattr#};
		allow vold app_data_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow appdomain app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow -isolated_app app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow drmserver app_data_file:file {#read#write#getattr#};
		allow init -app_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
		allow installd system_app_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow installd app_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow isolated_app app_data_file:file {#read#write#getattr#lock#};
		allow kernel app_data_file:file read;
		allow mediaserver app_data_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger app_data_file:file {#read#write#};
		allow system_app system_app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server system_app_data_file:file {#getattr#read#write#};
		allow system_server app_data_file:file {#getattr#read#write#};
		allow system_server system_app_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow uncrypt app_data_file:file {#getattr#open#read#ioctl#lock#};
		allow untrusted_app app_data_file:file {#{#{#getattr#open#read#ioctl#lock#}#{#getattr#execute#execute_no_trans#}#}#execmod#};
		allow untrusted_app system_app_data_file:file {#read#write#getattr#};
		allow vold app_data_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow isolated_app app_data_file:file open;
		neverallow logd app_data_file:file write;
		neverallow netd app_data_file:file write;

ion_device:chr_file 
	WRITES: 
		allow domain ion_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain ion_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

tmpfs:chr_file 
	WRITES: 
		allow fsck tmpfs:chr_file {#read#write#ioctl#};
		allow init tmpfs:chr_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow init tmpfs:chr_file write;
		allow kernel tmpfs:chr_file write;
		allow toolbox tmpfs:chr_file {#read#write#ioctl#};
		allow ueventd tmpfs:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow fsck tmpfs:chr_file {#read#write#ioctl#};
		allow init tmpfs:chr_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow toolbox tmpfs:chr_file {#read#write#ioctl#};
		allow ueventd tmpfs:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

binder_device:chr_file 
	WRITES: 
		allow domain binder_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain binder_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

self:file 
	WRITES: 
		allow domain self:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain self:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

dalvikcache_data_file:dir 
	WRITES: 
		allow installd dalvikcache_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow installd dalvikcache_data_file:dir relabelto;
		allow zygote dalvikcache_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow domain dalvikcache_data_file:dir {#search#getattr#};
		allow installd dalvikcache_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server dalvikcache_data_file:dir {#open#getattr#read#search#ioctl#};
		allow zygote dalvikcache_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

appdomain:tcp_socket 
	WRITES: 
		allow system_server appdomain:tcp_socket {#getattr#getopt#setopt#read#write#shutdown#};
	READS: 
		allow system_server appdomain:tcp_socket {#getattr#getopt#setopt#read#write#shutdown#};
	NEVERALLOWS: 

-ueventd:process 
	WRITES: 
		allow debuggerd -ueventd:process {#ptrace#getattr#};
	READS: 
		allow debuggerd -ueventd:process {#ptrace#getattr#};
	NEVERALLOWS: 

self:netlink_audit_socket 
	WRITES: 
		allow logd self:netlink_audit_socket {#{#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#}#nlmsg_write#};
	READS: 
		allow logd self:netlink_audit_socket {#{#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#}#nlmsg_write#};
	NEVERALLOWS: 

heapdump_data_file:file 
	WRITES: 
		allow system_server heapdump_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow system_server heapdump_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

self:fifo_file 
	WRITES: 
		allow domain self:fifo_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain self:fifo_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

media_data_file:file 
	WRITES: 
		allow mediaserver media_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow mediaserver media_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

debuggerd_tmpfs:file 
	WRITES: 
		allow debuggerd debuggerd_tmpfs:file {#read#write#};
	READS: 
		allow debuggerd debuggerd_tmpfs:file {#read#write#};
	NEVERALLOWS: 

uncrypt_tmpfs:file 
	WRITES: 
		allow uncrypt uncrypt_tmpfs:file {#read#write#};
	READS: 
		allow uncrypt uncrypt_tmpfs:file {#read#write#};
	NEVERALLOWS: 

unencrypted_data_file:file 
	WRITES: 
		allow vold unencrypted_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow vold unencrypted_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

system_app_data_file:sock_file 
	WRITES: 
		allow installd system_app_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	READS: 
		allow installd system_app_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	NEVERALLOWS: 

drmserver_tmpfs:file 
	WRITES: 
		allow drmserver drmserver_tmpfs:file {#read#write#};
	READS: 
		allow drmserver drmserver_tmpfs:file {#read#write#};
	NEVERALLOWS: 

system_ndebug_socket:sock_file 
	WRITES: 
		allow debuggerd system_ndebug_socket:sock_file write;
		allow system_server system_ndebug_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow system_server system_ndebug_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

fingerprintd:process 
	WRITES: 
		allow init fingerprintd:process transition;
	READS: 
		allow servicemanager fingerprintd:process getattr;
	NEVERALLOWS: 

userdata_block_device:blk_file 
	WRITES: 
		allow fsck userdata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow uncrypt userdata_block_device:blk_file {#open#append#write#};
		allow vold userdata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow blkid userdata_block_device:blk_file {#getattr#open#read#ioctl#lock#};
		allow fsck userdata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold userdata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

unlabeled:fifo_file 
	WRITES: 
		allow init unlabeled:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#};
		allow installd unlabeled:fifo_file {#getattr#relabelfrom#rename#unlink#setattr#};
	READS: 
		allow init unlabeled:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#};
		allow installd unlabeled:fifo_file {#getattr#relabelfrom#rename#unlink#setattr#};
	NEVERALLOWS: 
		neverallow domain unlabeled:fifo_file create;
		neverallow -init unlabeled:fifo_file create;
		neverallow -recovery unlabeled:fifo_file create;

shared_relro_file:file 
	WRITES: 
		allow shared_relro shared_relro_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain shared_relro_file:file {#getattr#open#read#ioctl#lock#};
		allow debuggerd shared_relro_file:file {#getattr#open#read#ioctl#lock#};
		allow shared_relro shared_relro_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

system_data_file:dir 
	WRITES: 
		allow debuggerd system_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow dumpstate system_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#};
		allow installd system_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_app system_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server system_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold system_data_file:dir {#create#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#mounton#setattr#rmdir#};
	READS: 
		allow appdomain system_data_file:dir {#open#getattr#read#search#ioctl#};
		allow debuggerd system_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow debuggerd system_data_file:dir relabelfrom;
		allow domain system_data_file:dir {#search#getattr#};
		allow dumpstate system_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#};
		allow installd system_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow installd system_data_file:dir relabelfrom;
		allow rild system_data_file:dir {#open#getattr#read#search#ioctl#};
		allow system_app system_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server system_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server system_data_file:dir relabelfrom;
		allow vold system_data_file:dir {#create#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#mounton#setattr#rmdir#};
		allow zygote system_data_file:dir {#open#getattr#read#search#ioctl#};
	NEVERALLOWS: 
		neverallow logd system_data_file:dir write;
		neverallow netd system_data_file:dir write;

sysfs_lowmemorykiller:file 
	WRITES: 
		allow lmkd sysfs_lowmemorykiller:file {#open#append#write#};
		allow system_server sysfs_lowmemorykiller:file {#getattr#{#open#append#write#}#};
	READS: 
		allow system_server sysfs_lowmemorykiller:file {#getattr#{#open#append#write#}#};
	NEVERALLOWS: 

rootfs:dir 
	WRITES: 
		allow init -rootfs:dir {#open#read#setattr#search#};
		allow init rootfs:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow init rootfs:dir mounton;
		allow vold rootfs:dir mounton;
		allow zygote rootfs:dir mounton;
	READS: 
		allow domain rootfs:dir {#open#getattr#read#search#ioctl#};
		allow init -rootfs:dir {#open#read#setattr#search#};
		allow init rootfs:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow init rootfs:dir mounton;
		allow vold rootfs:dir mounton;
		allow zygote rootfs:dir mounton;
	NEVERALLOWS: 

surfaceflinger:process 
	WRITES: 
		allow dumpstate surfaceflinger:process signal;
		allow init surfaceflinger:process transition;
	READS: 
		allow servicemanager surfaceflinger:process getattr;
	NEVERALLOWS: 

loop_device:blk_file 
	WRITES: 
		allow vold loop_device:blk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow vold loop_device:blk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

-exec_type:file 
	WRITES: 
		allow init -exec_type:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	READS: 
		allow init -exec_type:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 
		neverallow domain -exec_type:file entrypoint;

-vold_data_file}:dir 
	WRITES: 
		allow init -vold_data_file}:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	READS: 
		allow init -vold_data_file}:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	NEVERALLOWS: 

fuse_device:chr_file 
	WRITES: 
		allow sdcardd fuse_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow sdcardd fuse_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

misc_logd_file:dir 
	WRITES: 
		allow logd misc_logd_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow logd misc_logd_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow shell misc_logd_file:dir {#open#getattr#read#search#ioctl#};
	NEVERALLOWS: 

dev_type:blk_file 
	WRITES: 
		allow ueventd dev_type:blk_file {#create#setattr#unlink#};
	READS: 
		allow init dev_type:blk_file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 
		neverallow appdomain dev_type:blk_file {#read#write#};
		neverallow logd dev_type:blk_file {#read#write#};
		neverallow netd dev_type:blk_file {#read#write#};

net_data_file:file 
	WRITES: 
		allow netd net_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow dumpstate net_data_file:file {#getattr#open#read#ioctl#lock#};
		allow netd net_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow radio net_data_file:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

unlabeled:sock_file 
	WRITES: 
		allow init unlabeled:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#};
		allow installd unlabeled:sock_file {#getattr#relabelfrom#rename#unlink#setattr#};
	READS: 
		allow init unlabeled:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#};
		allow installd unlabeled:sock_file {#getattr#relabelfrom#rename#unlink#setattr#};
	NEVERALLOWS: 
		neverallow domain unlabeled:sock_file create;
		neverallow -init unlabeled:sock_file create;
		neverallow -recovery unlabeled:sock_file create;

bootchart_data_file:file 
	WRITES: 
		allow shell bootchart_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow adbd bootchart_data_file:file {#getattr#open#read#ioctl#lock#};
		allow shell bootchart_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

dumpstate:unix_dgram_socket 
	WRITES: 
		allow vdc dumpstate:unix_dgram_socket {#read#write#};
	READS: 
		allow vdc dumpstate:unix_dgram_socket {#read#write#};
	NEVERALLOWS: 

dalvikcache_profiles_data_file:file 
	WRITES: 
		allow appdomain dalvikcache_profiles_data_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow installd dalvikcache_profiles_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server dalvikcache_profiles_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain dalvikcache_profiles_data_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow installd dalvikcache_profiles_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server dalvikcache_profiles_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

proc_sysrq:file 
	WRITES: 
		allow healthd proc_sysrq:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init proc_sysrq:file {#open#append#write#};
		allow kernel proc_sysrq:file {#open#append#write#};
		allow system_server proc_sysrq:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow healthd proc_sysrq:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server proc_sysrq:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

device:dir 
	WRITES: 
		allow init cpuctl_device:dir {#create#mounton#};
		allow init device:dir mounton;
		allow init device:dir relabelto;
		allow init socket_device:dir relabelto;
		allow vold block_device:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold device:dir write;
	READS: 
		allow blkid block_device:dir search;
		allow blkid_untrusted block_device:dir search;
		allow bootanim audio_device:dir {#open#getattr#read#search#ioctl#};
		allow domain device:dir search;
		allow domain socket_device:dir {#open#getattr#read#search#ioctl#};
		allow fsck block_device:dir search;
		allow fsck_untrusted block_device:dir search;
		allow healthd graphics_device:dir {#open#getattr#read#search#ioctl#};
		allow healthd input_device:dir {#open#getattr#read#search#ioctl#};
		allow init cpuctl_device:dir {#create#mounton#};
		allow init device:dir mounton;
		allow inputflinger input_device:dir {#open#getattr#read#search#ioctl#};
		allow install_recovery block_device:dir search;
		allow mediaserver audio_device:dir {#open#getattr#read#search#ioctl#};
		allow mediaserver video_device:dir {#open#getattr#read#search#ioctl#};
		allow rild mtd_device:dir search;
		allow sgdisk block_device:dir search;
		allow shell input_device:dir {#open#getattr#read#search#ioctl#};
		allow slideshow device:dir {#open#getattr#read#search#ioctl#};
		allow slideshow graphics_device:dir {#open#getattr#read#search#ioctl#};
		allow slideshow input_device:dir {#open#getattr#read#search#ioctl#};
		allow surfaceflinger graphics_device:dir search;
		allow surfaceflinger video_device:dir {#open#getattr#read#search#ioctl#};
		allow system_server audio_device:dir {#open#getattr#read#search#ioctl#};
		allow system_server block_device:dir search;
		allow system_server device:dir {#open#getattr#read#search#ioctl#};
		allow system_server input_device:dir {#open#getattr#read#search#ioctl#};
		allow system_server usb_device:dir {#open#getattr#read#search#ioctl#};
		allow system_server video_device:dir {#open#getattr#read#search#ioctl#};
		allow toolbox block_device:dir search;
		allow uncrypt block_device:dir {#open#getattr#read#search#ioctl#};
		allow vold block_device:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

gatekeeper_data_file:file 
	WRITES: 
		allow gatekeeperd gatekeeper_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow gatekeeperd gatekeeper_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

audio_data_file:dir 
	WRITES: 
		allow mediaserver audio_data_file:dir {#{#open#getattr#read#search#ioctl#}#add_name#write#};
	READS: 
		allow mediaserver audio_data_file:dir {#{#open#getattr#read#search#ioctl#}#add_name#write#};
	NEVERALLOWS: 

-app_data_file:file 
	WRITES: 
		allow init -app_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	READS: 
		allow init -app_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

device:chr_file 
	WRITES: 
		allow adbd adb_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow adbd gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow appdomain console_device:chr_file {#read#write#};
		allow appdomain gpu_device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#execute#};
		allow -isolated_app gpu_device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#execute#};
		allow appdomain usbaccessory_device:chr_file {#read#write#getattr#};
		allow appdomain usb_device:chr_file {#read#write#getattr#ioctl#};
		allow binderservicedomain console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow bluetooth tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow bluetooth uhid_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow bootanim audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow bootanim gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow clatd tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain ashmem_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain binder_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain ion_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain null_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain owntty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain pmsg_device:chr_file {#open#append#write#};
		allow domain ptmx_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain qemu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain random_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain urandom_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain zero_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow drmserver tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow dumpstate gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow gatekeeperd tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow gpsd gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow healthd graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow healthd kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow healthd tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#setattr#};
		allow init -kmem_device:chr_file {#read#open#setattr#};
		allow init dm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow inputflinger input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow keystore tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow logd kmsg_device:chr_file {#open#append#write#};
		allow mediaserver audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver camera_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver rpmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow nfc nfc_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow perfprofd pmsg_device:chr_file {#open#append#write#};
		allow ppp ppp_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow radio alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild radio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow sdcardd fuse_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server iio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server qtaguid_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server rtc_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server sensors_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server usbaccessory_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server usb_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow tee tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow ueventd device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow ueventd klog_device:chr_file {#create#open#write#unlink#};
		allow untrusted_app mtp_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow untrusted_app tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold dm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow watchdogd kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow watchdogd watchdog_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow adbd adb_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow adbd gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow appdomain ashmem_device:chr_file execute;
		allow appdomain console_device:chr_file {#read#write#};
		allow appdomain gpu_device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#execute#};
		allow -isolated_app gpu_device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#execute#};
		allow appdomain qtaguid_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow appdomain usbaccessory_device:chr_file {#read#write#getattr#};
		allow appdomain usb_device:chr_file {#read#write#getattr#ioctl#};
		allow binderservicedomain console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow bluetooth tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow bluetooth uhid_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow bootanim ashmem_device:chr_file execute;
		allow bootanim audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow bootanim gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow clatd tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain alarm_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow domain ashmem_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain binder_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain ion_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain null_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain owntty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain ptmx_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain qemu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain random_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain urandom_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow domain zero_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow drmserver tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow dumpstate ashmem_device:chr_file execute;
		allow dumpstate gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow gatekeeperd tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow gpsd gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow healthd ashmem_device:chr_file execute;
		allow healthd graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow healthd input_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow healthd kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow healthd tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#setattr#};
		allow init -kmem_device:chr_file {#read#open#setattr#};
		allow init dm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init hw_random_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow init tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow inputflinger input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow keystore tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver camera_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver qtaguid_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow mediaserver rpmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow nfc nfc_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow ppp ppp_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow racoon tun_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow radio alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild radio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow sdcardd fuse_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow input_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow slideshow kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow slideshow tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger graphics_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow surfaceflinger video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server ashmem_device:chr_file execute;
		allow system_server audio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server gpu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server hw_random_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow system_server iio_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server input_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server qtaguid_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server radio_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow system_server rtc_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server sensors_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server tty_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server usbaccessory_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server usb_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server video_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow tee tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow ueventd device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow untrusted_app mtp_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow untrusted_app tun_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold dm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold tee_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow watchdogd kmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow watchdogd watchdog_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow appdomain tee_device:chr_file {#read#write#};
		neverallow domain hw_random_device:chr_file *;
		neverallow -init hw_random_device:chr_file *;
		neverallow -system_server hw_random_device:chr_file *;
		neverallow -ueventd hw_random_device:chr_file *;
		neverallow domain device:chr_file {#open#read#write#};
		neverallow -init device:chr_file {#open#read#write#};
		neverallow -ueventd device:chr_file {#open#read#write#};
		neverallow domain kmem_device:chr_file *;
		neverallow -kernel kmem_device:chr_file *;
		neverallow -ueventd kmem_device:chr_file *;
		neverallow -init kmem_device:chr_file *;
		neverallow domain kmem_device:chr_file ~{#create#relabelto#unlink#setattr#};
		neverallow isolated_app gpu_device:chr_file {#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#execute#};
		neverallow untrusted_app graphics_device:chr_file {#read#write#};
		neverallow isolated_app graphics_device:chr_file {#read#write#};
		neverallow shell graphics_device:chr_file {#read#write#};

resourcecache_data_file:dir 
	WRITES: 
		allow installd resourcecache_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow zygote resourcecache_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow appdomain resourcecache_data_file:dir {#open#getattr#read#search#ioctl#};
		allow installd resourcecache_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server resourcecache_data_file:dir {#open#getattr#read#search#ioctl#};
		allow zygote resourcecache_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	NEVERALLOWS: 

bluetooth_data_file:file 
	WRITES: 
		allow bluetooth bluetooth_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow installd bluetooth_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow system_server bluetooth_data_file:file {#getattr#read#write#};
	READS: 
		allow bluetooth bluetooth_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow installd bluetooth_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow system_server bluetooth_data_file:file {#getattr#read#write#};
	NEVERALLOWS: 

untrusted_app_tmpfs:file 
	WRITES: 
		allow untrusted_app untrusted_app_tmpfs:file {#read#write#};
	READS: 
		allow untrusted_app untrusted_app_tmpfs:file execute;
		allow untrusted_app untrusted_app_tmpfs:file {#read#write#};
	NEVERALLOWS: 

racoon_tmpfs:file 
	WRITES: 
		allow racoon racoon_tmpfs:file {#read#write#};
	READS: 
		allow racoon racoon_tmpfs:file {#read#write#};
	NEVERALLOWS: 

bootanim:process 
	WRITES: 
		allow init bootanim:process transition;
	READS: 
		allow servicemanager bootanim:process getattr;
	NEVERALLOWS: 

mediaserver:udp_socket 
	WRITES: 
		allow system_server mediaserver:udp_socket {#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#};
	READS: 
		allow system_server mediaserver:udp_socket {#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#};
	NEVERALLOWS: 

cache_block_device:blk_file 
	WRITES: 
		allow fsck cache_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow fsck cache_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

vpn_data_file:file 
	WRITES: 
		allow ppp vpn_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow racoon vpn_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server vpn_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow ppp vpn_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow racoon vpn_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server vpn_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

app_data_file:sock_file 
	WRITES: 
		allow adbd app_data_file:sock_file write;
		allow appdomain app_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow -isolated_app app_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow init -app_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow installd system_app_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow installd app_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	READS: 
		allow appdomain app_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow -isolated_app app_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow init -app_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow installd system_app_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow installd app_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	NEVERALLOWS: 
		neverallow logd app_data_file:sock_file write;
		neverallow netd app_data_file:sock_file write;

lmkd_tmpfs:file 
	WRITES: 
		allow lmkd lmkd_tmpfs:file {#read#write#};
	READS: 
		allow lmkd lmkd_tmpfs:file {#read#write#};
	NEVERALLOWS: 

bluetooth_socket:sock_file 
	WRITES: 
		allow bluetooth bluetooth_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow mediaserver bluetooth_socket:sock_file write;
	READS: 
		allow bluetooth bluetooth_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

tmpfs:file 
	WRITES: 
		allow bluetooth bluetooth_tmpfs:file {#read#write#};
		allow bootanim bootanim_tmpfs:file {#read#write#};
		allow debuggerd debuggerd_tmpfs:file {#read#write#};
		allow dhcp dhcp_tmpfs:file {#read#write#};
		allow drmserver drmserver_tmpfs:file {#read#write#};
		allow dumpstate dumpstate_tmpfs:file {#read#write#};
		allow fingerprintd fingerprintd_tmpfs:file {#read#write#};
		allow fsck fsck_tmpfs:file {#read#write#};
		allow gatekeeperd gatekeeperd_tmpfs:file {#read#write#};
		allow gpsd gpsd_tmpfs:file {#read#write#};
		allow hci_attach hci_attach_tmpfs:file {#read#write#};
		allow init init_tmpfs:file {#read#write#};
		allow init tmpfs:file unlink;
		allow inputflinger inputflinger_tmpfs:file {#read#write#};
		allow installd installd_tmpfs:file {#read#write#};
		allow install_recovery install_recovery_tmpfs:file {#read#write#};
		allow isolated_app isolated_app_tmpfs:file {#read#write#};
		allow keystore keystore_tmpfs:file {#read#write#};
		allow lmkd lmkd_tmpfs:file {#read#write#};
		allow logd logd_tmpfs:file {#read#write#};
		allow mdnsd mdnsd_tmpfs:file {#read#write#};
		allow mediaserver mediaserver_tmpfs:file {#read#write#};
		allow mtp mtp_tmpfs:file {#read#write#};
		allow netd netd_tmpfs:file {#read#write#};
		allow nfc nfc_tmpfs:file {#read#write#};
		allow perfprofd perfprofd_tmpfs:file {#read#write#};
		allow platform_app platform_app_tmpfs:file {#read#write#};
		allow racoon racoon_tmpfs:file {#read#write#};
		allow radio radio_tmpfs:file {#read#write#};
		allow rild rild_tmpfs:file {#read#write#};
		allow servicemanager servicemanager_tmpfs:file {#read#write#};
		allow shared_relro shared_relro_tmpfs:file {#read#write#};
		allow shell shell_tmpfs:file {#read#write#};
		allow surfaceflinger surfaceflinger_tmpfs:file {#read#write#};
		allow su su_tmpfs:file {#read#write#};
		allow system_app system_app_tmpfs:file {#read#write#};
		allow system_server system_server_tmpfs:file {#read#write#};
		allow tee tee_tmpfs:file {#read#write#};
		allow toolbox toolbox_tmpfs:file {#read#write#};
		allow tzdatacheck tzdatacheck_tmpfs:file {#read#write#};
		allow ueventd ueventd_tmpfs:file {#read#write#};
		allow uncrypt uncrypt_tmpfs:file {#read#write#};
		allow untrusted_app untrusted_app_tmpfs:file {#read#write#};
		allow vdc vdc_tmpfs:file {#read#write#};
		allow vold vold_tmpfs:file {#read#write#};
		allow wpa wpa_tmpfs:file {#read#write#};
		allow zygote zygote_tmpfs:file {#read#write#};
	READS: 
		allow appdomain zygote_tmpfs:file read;
		allow bluetooth bluetooth_tmpfs:file execute;
		allow bluetooth bluetooth_tmpfs:file {#read#write#};
		allow bootanim bootanim_tmpfs:file {#read#write#};
		allow debuggerd debuggerd_tmpfs:file {#read#write#};
		allow dhcp dhcp_tmpfs:file {#read#write#};
		allow domain tmpfs:file {#read#getattr#};
		allow drmserver drmserver_tmpfs:file {#read#write#};
		allow dumpstate dumpstate_tmpfs:file execute;
		allow dumpstate dumpstate_tmpfs:file {#read#write#};
		allow fingerprintd fingerprintd_tmpfs:file {#read#write#};
		allow fsck fsck_tmpfs:file {#read#write#};
		allow gatekeeperd gatekeeperd_tmpfs:file {#read#write#};
		allow gpsd gpsd_tmpfs:file {#read#write#};
		allow hci_attach hci_attach_tmpfs:file {#read#write#};
		allow init init_tmpfs:file {#read#write#};
		allow init tmpfs:file relabelfrom;
		allow inputflinger inputflinger_tmpfs:file {#read#write#};
		allow installd installd_tmpfs:file {#read#write#};
		allow install_recovery install_recovery_tmpfs:file {#read#write#};
		allow isolated_app isolated_app_tmpfs:file execute;
		allow isolated_app isolated_app_tmpfs:file {#read#write#};
		allow keystore keystore_tmpfs:file {#read#write#};
		allow lmkd lmkd_tmpfs:file {#read#write#};
		allow logd logd_tmpfs:file {#read#write#};
		allow mdnsd mdnsd_tmpfs:file {#read#write#};
		allow mediaserver mediaserver_tmpfs:file {#read#write#};
		allow mtp mtp_tmpfs:file {#read#write#};
		allow netd netd_tmpfs:file {#read#write#};
		allow nfc nfc_tmpfs:file execute;
		allow nfc nfc_tmpfs:file {#read#write#};
		allow perfprofd perfprofd_tmpfs:file {#read#write#};
		allow platform_app platform_app_tmpfs:file execute;
		allow platform_app platform_app_tmpfs:file {#read#write#};
		allow racoon racoon_tmpfs:file {#read#write#};
		allow radio radio_tmpfs:file execute;
		allow radio radio_tmpfs:file {#read#write#};
		allow rild rild_tmpfs:file {#read#write#};
		allow servicemanager servicemanager_tmpfs:file {#read#write#};
		allow shared_relro shared_relro_tmpfs:file execute;
		allow shared_relro shared_relro_tmpfs:file {#read#write#};
		allow shell shell_tmpfs:file execute;
		allow shell shell_tmpfs:file {#read#write#};
		allow surfaceflinger surfaceflinger_tmpfs:file {#read#write#};
		allow su su_tmpfs:file execute;
		allow su su_tmpfs:file {#read#write#};
		allow system_app system_app_tmpfs:file execute;
		allow system_app system_app_tmpfs:file {#read#write#};
		allow system_server system_server_tmpfs:file execute;
		allow system_server system_server_tmpfs:file {#read#write#};
		allow system_server zygote_tmpfs:file read;
		allow tee tee_tmpfs:file {#read#write#};
		allow toolbox toolbox_tmpfs:file {#read#write#};
		allow tzdatacheck tzdatacheck_tmpfs:file {#read#write#};
		allow ueventd ueventd_tmpfs:file {#read#write#};
		allow uncrypt uncrypt_tmpfs:file {#read#write#};
		allow untrusted_app untrusted_app_tmpfs:file execute;
		allow untrusted_app untrusted_app_tmpfs:file {#read#write#};
		allow vdc vdc_tmpfs:file {#read#write#};
		allow vold vold_tmpfs:file {#read#write#};
		allow wpa wpa_tmpfs:file {#read#write#};
		allow zygote zygote_tmpfs:file {#read#write#};
	NEVERALLOWS: 

install_recovery_tmpfs:file 
	WRITES: 
		allow install_recovery install_recovery_tmpfs:file {#read#write#};
	READS: 
		allow install_recovery install_recovery_tmpfs:file {#read#write#};
	NEVERALLOWS: 

dumpstate:unix_stream_socket 
	WRITES: 
		allow appdomain dumpstate:unix_stream_socket {#read#write#getopt#getattr#shutdown#};
		allow binderservicedomain dumpstate:unix_stream_socket {#read#write#getopt#getattr#};
		allow shell dumpstate:unix_stream_socket connectto;
		allow vdc dumpstate:unix_stream_socket {#read#write#getattr#};
	READS: 
		allow appdomain dumpstate:unix_stream_socket {#read#write#getopt#getattr#shutdown#};
		allow binderservicedomain dumpstate:unix_stream_socket {#read#write#getopt#getattr#};
		allow vdc dumpstate:unix_stream_socket {#read#write#getattr#};
	NEVERALLOWS: 

{file_type:lnk_file 
	WRITES: 
		allow init {file_type:lnk_file relabelto;
		allow init {file_type:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	READS: 
		allow init {file_type:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

appdomain:unix_stream_socket 
	WRITES: 
		allow adbd appdomain:unix_stream_socket connectto;
		allow appdomain appdomain:unix_stream_socket {#getopt#getattr#read#write#shutdown#};
		allow system_server appdomain:unix_stream_socket {#getattr#read#write#};
	READS: 
		allow appdomain appdomain:unix_stream_socket {#getopt#getattr#read#write#shutdown#};
		allow system_server appdomain:unix_stream_socket {#getattr#read#write#};
	NEVERALLOWS: 

vfat:dir 
	WRITES: 
		allow platform_app vfat:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow appdomain vfat:dir {#open#getattr#read#search#ioctl#};
		allow platform_app vfat:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

apk_private_data_file:dir 
	WRITES: 
		allow system_server apk_private_data_file:dir {#relabelfrom#relabelto#};
		allow system_server apk_private_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow platform_app apk_private_data_file:dir search;
		allow system_server apk_private_data_file:dir {#relabelfrom#relabelto#};
		allow system_server apk_private_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

-keystore:process 
	WRITES: 
		allow debuggerd -keystore:process {#ptrace#getattr#};
	READS: 
		allow debuggerd -keystore:process {#ptrace#getattr#};
	NEVERALLOWS: 

backup_data_file:file 
	WRITES: 
		allow appdomain backup_data_file:file {#read#write#getattr#};
		allow system_server backup_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain backup_data_file:file {#read#write#getattr#};
		allow system_server backup_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

keystore_data_file:dir 
	WRITES: 
		allow init -keystore_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
		allow init keystore_data_file:dir {#open#create#read#getattr#setattr#search#};
		allow keystore keystore_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow init -keystore_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
		allow init keystore_data_file:dir {#open#create#read#getattr#setattr#search#};
		allow keystore keystore_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 
		neverallow domain keystore_data_file:dir *;
		neverallow -keystore keystore_data_file:dir *;
		neverallow -init keystore_data_file:dir *;
		neverallow domain keystore_data_file:dir ~{#open#create#read#getattr#setattr#search#relabelto#ioctl#};
		neverallow -keystore keystore_data_file:dir ~{#open#create#read#getattr#setattr#search#relabelto#ioctl#};

unlabeled:lnk_file 
	WRITES: 
		allow init unlabeled:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#};
		allow installd unlabeled:lnk_file {#getattr#relabelfrom#rename#unlink#setattr#};
	READS: 
		allow init unlabeled:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#};
		allow installd unlabeled:lnk_file {#getattr#relabelfrom#rename#unlink#setattr#};
	NEVERALLOWS: 
		neverallow domain unlabeled:lnk_file create;
		neverallow -init unlabeled:lnk_file create;
		neverallow -recovery unlabeled:lnk_file create;

mediaserver:fd 
	WRITES: 
		allow drmserver mediaserver:fd use;
	READS: 
		allow drmserver mediaserver:fd use;
	NEVERALLOWS: 

shell_data_file:fifo_file 
	WRITES: 
		allow init -shell_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow installd shell_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	READS: 
		allow init -shell_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow installd shell_data_file:fifo_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	NEVERALLOWS: 

sysfs_bluetooth_writable:file 
	WRITES: 
		allow bluetooth sysfs_bluetooth_writable:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow bluetooth sysfs_bluetooth_writable:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

self:netlink_nflog_socket 
	WRITES: 
		allow netd self:netlink_nflog_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	READS: 
		allow netd self:netlink_nflog_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	NEVERALLOWS: 

mtp_tmpfs:file 
	WRITES: 
		allow mtp mtp_tmpfs:file {#read#write#};
	READS: 
		allow mtp mtp_tmpfs:file {#read#write#};
	NEVERALLOWS: 

asec_image_file:file 
	WRITES: 
		allow vold asec_image_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow installd asec_image_file:file getattr;
		allow kernel asec_image_file:file read;
		allow vold asec_image_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

self:netlink_socket 
	WRITES: 
		allow hostapd self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow netd self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow rild self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow system_server self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow tee self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow wpa self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	READS: 
		allow hostapd self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow netd self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow rild self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow system_server self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow tee self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow wpa self:netlink_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	NEVERALLOWS: 

netd:netlink_nflog_socket 
	WRITES: 
		allow clatd netd:netlink_nflog_socket {#read#write#};
		allow dhcp netd:netlink_nflog_socket {#read#write#};
		allow dnsmasq netd:netlink_nflog_socket {#read#write#};
		allow hostapd netd:netlink_nflog_socket {#read#write#};
	READS: 
		allow clatd netd:netlink_nflog_socket {#read#write#};
		allow dhcp netd:netlink_nflog_socket {#read#write#};
		allow dnsmasq netd:netlink_nflog_socket {#read#write#};
		allow hostapd netd:netlink_nflog_socket {#read#write#};
	NEVERALLOWS: 

-keystore_data_file:file 
	WRITES: 
		allow init -keystore_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	READS: 
		allow init -keystore_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

-rootfs:file 
	WRITES: 
		allow init -rootfs:file {#open#read#setattr#};
	READS: 
		allow init -rootfs:file {#open#read#setattr#};
	NEVERALLOWS: 
		neverallow kernel -rootfs:file {#entrypoint#execute_no_trans#};

qemu_device:chr_file 
	WRITES: 
		allow domain qemu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain qemu_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

ashmem_device:chr_file 
	WRITES: 
		allow domain ashmem_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow appdomain ashmem_device:chr_file execute;
		allow bootanim ashmem_device:chr_file execute;
		allow domain ashmem_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow dumpstate ashmem_device:chr_file execute;
		allow healthd ashmem_device:chr_file execute;
		allow system_server ashmem_device:chr_file execute;
	NEVERALLOWS: 

heapdump_data_file:dir 
	WRITES: 
		allow system_server heapdump_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow system_server heapdump_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	NEVERALLOWS: 

keystore_data_file:fifo_file 
	WRITES: 
		allow init -keystore_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow keystore keystore_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow init -keystore_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow keystore keystore_data_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 
		neverallow domain keystore_data_file:fifo_file *;
		neverallow -keystore keystore_data_file:fifo_file *;
		neverallow -init keystore_data_file:fifo_file *;
		neverallow domain keystore_data_file:fifo_file ~{#relabelto#getattr#};
		neverallow -keystore keystore_data_file:fifo_file ~{#relabelto#getattr#};

gps_data_file:dir 
	WRITES: 
		allow gpsd gps_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow gpsd gps_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	NEVERALLOWS: 

logd_tmpfs:file 
	WRITES: 
		allow logd logd_tmpfs:file {#read#write#};
	READS: 
		allow logd logd_tmpfs:file {#read#write#};
	NEVERALLOWS: 

socket_device:dir 
	WRITES: 
		allow init socket_device:dir relabelto;
	READS: 
		allow domain socket_device:dir {#open#getattr#read#search#ioctl#};
	NEVERALLOWS: 

mdnsd_tmpfs:file 
	WRITES: 
		allow mdnsd mdnsd_tmpfs:file {#read#write#};
	READS: 
		allow mdnsd mdnsd_tmpfs:file {#read#write#};
	NEVERALLOWS: 

-exec_type:fifo_file 
	WRITES: 
		allow init -exec_type:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -exec_type:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

fs_type:filesystem 
	WRITES: 
		allow init fs_type:filesystem ~relabelto;
	READS: 
		allow domain fs_type:filesystem getattr;
	NEVERALLOWS: 
		neverallow appdomain fs_type:filesystem ~getattr;
		neverallow domain {fs_type:filesystem relabelto;
		neverallow domain fs_type:filesystem {#mount#remount#relabelfrom#relabelto#};
		neverallow -kernel fs_type:filesystem {#mount#remount#relabelfrom#relabelto#};
		neverallow -init fs_type:filesystem {#mount#remount#relabelfrom#relabelto#};
		neverallow -recovery fs_type:filesystem {#mount#remount#relabelfrom#relabelto#};
		neverallow -vold fs_type:filesystem {#mount#remount#relabelfrom#relabelto#};
		neverallow -zygote fs_type:filesystem {#mount#remount#relabelfrom#relabelto#};

net_data_file:dir 
	WRITES: 
		allow netd net_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow dumpstate net_data_file:dir search;
		allow netd net_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow radio net_data_file:dir search;
	NEVERALLOWS: 

netdomain:rawip_socket 
	WRITES: 
		allow netd netdomain:rawip_socket {read#write#getattr#setattr#getopt#setopt};
	READS: 
		allow netd netdomain:rawip_socket {read#write#getattr#setattr#getopt#setopt};
	NEVERALLOWS: 

{file_type:dir 
	WRITES: 
		allow init {file_type:dir {#create#search#getattr#open#read#setattr#ioctl#};
		allow init {file_type:dir relabelto;
		allow init {file_type:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	READS: 
		allow init {file_type:dir {#create#search#getattr#open#read#setattr#ioctl#};
		allow init {file_type:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	NEVERALLOWS: 

sysfs_type:file 
	WRITES: 
		allow init sysfs_type:file relabelto;
		allow init sysfs_type:file {#open#append#write#};
		allow ueventd sysfs_type:file {#relabelfrom#relabelto#setattr#getattr#};
	READS: 
		allow ueventd sysfs_type:file {#relabelfrom#relabelto#setattr#getattr#};
	NEVERALLOWS: 

device:file 
	WRITES: 
		allow init device:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow init properties_device:file relabelto;
		allow ueventd device:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow domain device:file read;
		allow domain properties_device:file {#getattr#open#read#ioctl#lock#};
		allow init device:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow ueventd device:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

-system_file:lnk_file 
	WRITES: 
		allow init -system_file:lnk_file relabelto;
		allow init -system_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	READS: 
		allow init -system_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

app_data_file:dir 
	WRITES: 
		allow appdomain app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow -isolated_app app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow init -app_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
		allow installd system_app_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow installd app_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow system_app system_app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server system_app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow adbd app_data_file:dir search;
		allow appdomain app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow -isolated_app app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow init -app_data_file:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
		allow installd system_app_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow installd app_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#relabelto#};
		allow mediaserver app_data_file:dir search;
		allow runas app_data_file:dir {#getattr#search#};
		allow system_app system_app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server system_app_data_file:dir {#getattr#read#search#};
		allow system_server app_data_file:dir {#getattr#read#search#};
		allow system_server system_app_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow uncrypt app_data_file:dir {#open#getattr#read#search#ioctl#};
		allow vold app_data_file:dir search;
	NEVERALLOWS: 
		neverallow logd app_data_file:dir write;
		neverallow netd app_data_file:dir write;

cgroup:file 
	WRITES: 
		allow domain cgroup:file {#open#append#write#};
	READS: 
		allow domain cgroup:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

-exec_type:lnk_file 
	WRITES: 
		allow init -exec_type:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	READS: 
		allow init -exec_type:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

proc_net:file 
	WRITES: 
		allow dhcp proc_net:file write;
		allow init proc_net:file {#open#append#write#};
		allow netd proc_net:file write;
	READS: 
		allow domain proc_net:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

-vold_data_file}:lnk_file 
	WRITES: 
		allow init -vold_data_file}:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	READS: 
		allow init -vold_data_file}:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

adbd:fd 
	WRITES: 
		allow domain adbd:fd use;
		allow surfaceflinger adbd:fd use;
	READS: 
		allow domain adbd:fd use;
		allow surfaceflinger adbd:fd use;
	NEVERALLOWS: 

wpa_socket:dir 
	WRITES: 
		allow hostapd wpa_socket:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server wpa_socket:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow wpa wpa_socket:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow hostapd wpa_socket:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server wpa_socket:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow wpa wpa_socket:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

system_server:fd 
	WRITES: 
		allow domain system_server:fd use;
		allow drmserver system_server:fd use;
		allow fingerprintd system_server:fd use;
		allow healthd system_server:fd use;
		allow inputflinger system_server:fd use;
	READS: 
		allow domain system_server:fd use;
		allow drmserver system_server:fd use;
		allow fingerprintd system_server:fd use;
		allow healthd system_server:fd use;
		allow inputflinger system_server:fd use;
	NEVERALLOWS: 

system_data_file:file 
	WRITES: 
		allow installd system_data_file:file {#getattr#relabelfrom#unlink#};
		allow system_app system_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server system_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain system_data_file:file {#execute#execute_no_trans#open#execmod#};
		allow domain system_data_file:file {#getattr#read#};
		allow dumpstate system_data_file:file {#getattr#open#read#ioctl#lock#};
		allow installd system_data_file:file {#getattr#relabelfrom#unlink#};
		allow logd system_data_file:file {#getattr#open#read#ioctl#lock#};
		allow rild system_data_file:file {#getattr#open#read#ioctl#lock#};
		allow runas system_data_file:file {#getattr#open#read#ioctl#lock#};
		allow sdcardd system_data_file:file {#getattr#open#read#ioctl#lock#};
		allow system_app system_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server system_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server system_data_file:file relabelfrom;
		allow zygote system_data_file:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 
		neverallow installd system_data_file:file ~{#{#getattr#open#read#ioctl#lock#}#relabelfrom#unlink#};
		neverallow logd system_data_file:file write;
		neverallow netd system_data_file:file write;

app_data_file:lnk_file 
	WRITES: 
		allow appdomain app_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow -isolated_app app_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow init -app_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
		allow installd system_app_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow installd app_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow system_app system_app_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain app_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow -isolated_app app_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow init -app_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
		allow installd system_app_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow installd app_data_file:lnk_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow system_app system_app_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow uncrypt app_data_file:lnk_file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 
		neverallow init app_data_file:lnk_file read;
		neverallow logd app_data_file:lnk_file write;
		neverallow netd app_data_file:lnk_file write;

system_data_file:lnk_file 
	WRITES: 
		allow installd system_data_file:lnk_file {#getattr#relabelfrom#unlink#};
		allow installd system_data_file:lnk_file {#create#setattr#unlink#};
		allow system_server system_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain system_data_file:lnk_file getattr;
		allow domain system_data_file:lnk_file {#getattr#open#read#ioctl#lock#};
		allow installd system_data_file:lnk_file {#getattr#relabelfrom#unlink#};
		allow system_server system_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 
		neverallow logd system_data_file:lnk_file write;
		neverallow netd system_data_file:lnk_file write;

storage_file:dir 
	WRITES: 
		allow vold storage_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold storage_file:dir mounton;
		allow zygote storage_file:dir {#search#mounton#};
	READS: 
		allow adbd storage_file:dir {#open#getattr#read#search#ioctl#};
		allow appdomain storage_file:dir {#open#getattr#read#search#ioctl#};
		allow dumpstate storage_file:dir search;
		allow sdcardd storage_file:dir search;
		allow system_server storage_file:dir {#getattr#search#};
		allow vold storage_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold storage_file:dir mounton;
		allow zygote storage_file:dir {#search#mounton#};
	NEVERALLOWS: 

-shell_data_file:file 
	WRITES: 
		allow init -shell_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	READS: 
		allow init -shell_data_file:file {#create#getattr#open#read#write#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

netd:unix_stream_socket 
	WRITES: 
		allow clatd netd:unix_stream_socket {#read#write#};
		allow dhcp netd:unix_stream_socket {#read#write#};
		allow dnsmasq netd:unix_stream_socket {#read#write#};
		allow hostapd netd:unix_stream_socket {#read#write#};
		allow netdomain netd:unix_stream_socket connectto;
		allow system_server netd:unix_stream_socket connectto;
	READS: 
		allow clatd netd:unix_stream_socket {#read#write#};
		allow dhcp netd:unix_stream_socket {#read#write#};
		allow dnsmasq netd:unix_stream_socket {#read#write#};
		allow hostapd netd:unix_stream_socket {#read#write#};
	NEVERALLOWS: 

mediaserver:process 
	WRITES: 
		allow dumpstate mediaserver:process signal;
		allow init mediaserver:process transition;
		allow system_server mediaserver:process {#getsched#setsched#};
	READS: 
		allow servicemanager mediaserver:process getattr;
		allow system_server mediaserver:process {#getsched#setsched#};
	NEVERALLOWS: 

vold:fd 
	WRITES: 
		allow blkid_untrusted vold:fd use;
		allow blkid vold:fd use;
		allow fsck_untrusted vold:fd use;
		allow fsck vold:fd use;
		allow kernel vold:fd use;
		allow sdcardd vold:fd use;
		allow sgdisk vold:fd use;
	READS: 
		allow blkid_untrusted vold:fd use;
		allow blkid vold:fd use;
		allow fsck_untrusted vold:fd use;
		allow fsck vold:fd use;
		allow kernel vold:fd use;
		allow sdcardd vold:fd use;
		allow sgdisk vold:fd use;
	NEVERALLOWS: 

binderservicedomain:fd 
	WRITES: 
		allow appdomain binderservicedomain:fd use;
		allow dumpstate binderservicedomain:fd use;
		allow mediaserver binderservicedomain:fd use;
		allow surfaceflinger binderservicedomain:fd use;
		allow system_server binderservicedomain:fd use;
	READS: 
		allow appdomain binderservicedomain:fd use;
		allow dumpstate binderservicedomain:fd use;
		allow mediaserver binderservicedomain:fd use;
		allow surfaceflinger binderservicedomain:fd use;
		allow system_server binderservicedomain:fd use;
	NEVERALLOWS: 

-init:process 
	WRITES: 
		allow debuggerd -init:process {#ptrace#getattr#};
	READS: 
		allow debuggerd -init:process {#ptrace#getattr#};
	NEVERALLOWS: 

-sdcard_type:file 
	WRITES: 
		allow init -sdcard_type:file {#open#read#setattr#};
	READS: 
		allow init -sdcard_type:file {#open#read#setattr#};
	NEVERALLOWS: 

healthd:process 
	WRITES: 
		allow debuggerd -healthd:process {#ptrace#getattr#};
		allow init healthd:process transition;
	READS: 
		allow debuggerd -healthd:process {#ptrace#getattr#};
		allow servicemanager healthd:process getattr;
	NEVERALLOWS: 

untrusted_app:fd 
	WRITES: 
		allow kernel untrusted_app:fd use;
	READS: 
		allow kernel untrusted_app:fd use;
	NEVERALLOWS: 

apk_data_file:lnk_file 
	WRITES: 
		allow installd apk_data_file:lnk_file {#create#read#unlink#};
	READS: 
		allow domain apk_data_file:lnk_file {#getattr#open#read#ioctl#lock#};
		allow installd apk_data_file:lnk_file {#create#read#unlink#};
		allow shell apk_data_file:lnk_file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

proc_cpuinfo:file 
	WRITES: 
		allow zygote proc_cpuinfo:file mounton;
	READS: 
		allow domain proc_cpuinfo:file {#getattr#open#read#ioctl#lock#};
		allow zygote proc_cpuinfo:file mounton;
	NEVERALLOWS: 

usbaccessory_device:chr_file 
	WRITES: 
		allow appdomain usbaccessory_device:chr_file {#read#write#getattr#};
		allow system_server usbaccessory_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow appdomain usbaccessory_device:chr_file {#read#write#getattr#};
		allow system_server usbaccessory_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

dev_type:chr_file 
	WRITES: 
		allow init dev_type:chr_file {#read#open#setattr#};
		allow ueventd dev_type:chr_file {#create#setattr#unlink#};
	READS: 
		allow init dev_type:chr_file {#read#open#setattr#};
	NEVERALLOWS: 

-security_file:lnk_file 
	WRITES: 
		allow init -security_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	READS: 
		allow init -security_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

rootfs:lnk_file 
	WRITES: 
		allow init rootfs:lnk_file {#create#unlink#};
	READS: 
		allow domain rootfs:lnk_file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

storage_file:file 
	WRITES: 
		allow vold storage_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow vold storage_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

init_tmpfs:file 
	WRITES: 
		allow init init_tmpfs:file {#read#write#};
	READS: 
		allow init init_tmpfs:file {#read#write#};
	NEVERALLOWS: 

drmserver_socket:sock_file 
	WRITES: 
		allow drmserver drmserver_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow mediaserver drmserver_socket:sock_file write;
	READS: 
		allow drmserver drmserver_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

swap_block_device:blk_file 
	WRITES: 
		allow init swap_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow toolbox swap_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow init swap_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow toolbox swap_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

keystore_data_file:lnk_file 
	WRITES: 
		allow init -keystore_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
		allow keystore keystore_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow init -keystore_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
		allow keystore keystore_data_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 
		neverallow domain keystore_data_file:lnk_file *;
		neverallow -keystore keystore_data_file:lnk_file *;
		neverallow -init keystore_data_file:lnk_file *;
		neverallow domain keystore_data_file:lnk_file ~{#relabelto#getattr#};
		neverallow -keystore keystore_data_file:lnk_file ~{#relabelto#getattr#};

keychain_data_file:dir 
	WRITES: 
		allow installd keychain_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server keychain_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow appdomain keychain_data_file:dir {#open#getattr#read#search#ioctl#};
		allow installd keychain_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_app keychain_data_file:dir {#open#getattr#read#search#ioctl#};
		allow system_server keychain_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

property_data_file:dir 
	WRITES: 
		allow init property_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow init property_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 
		neverallow domain property_data_file:dir {#add_name#create#link#relabelfrom#remove_name#rename#reparent#rmdir#setattr#write#};
		neverallow -init property_data_file:dir {#add_name#create#link#relabelfrom#remove_name#rename#reparent#rmdir#setattr#write#};

radio_data_file:file 
	WRITES: 
		allow appdomain radio_data_file:file {#read#write#getattr#};
		allow installd radio_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow radio radio_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow rild radio_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server radio_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server radio_data_file:file {#getattr#read#write#};
	READS: 
		allow appdomain radio_data_file:file {#read#write#getattr#};
		allow drmserver radio_data_file:file {#read#getattr#};
		allow installd radio_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow mediaserver radio_data_file:file {#read#getattr#};
		allow radio radio_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow rild radio_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server radio_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server radio_data_file:file {#getattr#read#write#};
	NEVERALLOWS: 

su_tmpfs:file 
	WRITES: 
		allow su su_tmpfs:file {#read#write#};
	READS: 
		allow su su_tmpfs:file execute;
		allow su su_tmpfs:file {#read#write#};
	NEVERALLOWS: 

gatekeeperd_tmpfs:file 
	WRITES: 
		allow gatekeeperd gatekeeperd_tmpfs:file {#read#write#};
	READS: 
		allow gatekeeperd gatekeeperd_tmpfs:file {#read#write#};
	NEVERALLOWS: 

-app_data_file:fifo_file 
	WRITES: 
		allow init -app_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -app_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

zygote:fd 
	WRITES: 
		allow appdomain zygote:fd use;
		allow system_server zygote:fd use;
	READS: 
		allow appdomain zygote:fd use;
		allow system_server zygote:fd use;
	NEVERALLOWS: 

dumpstate:process 
	WRITES: 
		allow init dumpstate:process transition;
		allow procrank dumpstate:process sigchld;
		allow su dumpstate:process sigchld;
		allow su dumpstate:process transition;
		allow vdc dumpstate:process sigchld;
	READS: 
		allow servicemanager dumpstate:process getattr;
	NEVERALLOWS: 

netd:netlink_route_socket 
	WRITES: 
		allow clatd netd:netlink_route_socket {#read#write#};
		allow dhcp netd:netlink_route_socket {#read#write#};
		allow dnsmasq netd:netlink_route_socket {#read#write#};
		allow hostapd netd:netlink_route_socket {#read#write#};
	READS: 
		allow clatd netd:netlink_route_socket {#read#write#};
		allow dhcp netd:netlink_route_socket {#read#write#};
		allow dnsmasq netd:netlink_route_socket {#read#write#};
		allow hostapd netd:netlink_route_socket {#read#write#};
	NEVERALLOWS: 

asec_image_file:dir 
	WRITES: 
		allow vold asec_image_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow installd asec_image_file:dir search;
		allow vold asec_image_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	NEVERALLOWS: 

fingerprintd_data_file:file 
	WRITES: 
		allow fingerprintd fingerprintd_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#};
	READS: 
		allow fingerprintd fingerprintd_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#};
	NEVERALLOWS: 

gps_data_file:sock_file 
	WRITES: 
		allow gpsd gps_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow gpsd gps_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

adb_keys_file:dir 
	WRITES: 
		allow system_server adb_keys_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow adbd adb_keys_file:dir search;
		allow system_server adb_keys_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

camera_device:chr_file 
	WRITES: 
		allow mediaserver camera_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow mediaserver camera_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

-app_data_file:sock_file 
	WRITES: 
		allow init -app_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -app_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

fscklogs:dir 
	WRITES: 
		allow system_server fscklogs:dir {#write#remove_name#};
		allow vold fscklogs:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow system_server fscklogs:dir {#open#getattr#read#search#ioctl#};
		allow vold fscklogs:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	NEVERALLOWS: 

systemkeys_data_file:dir 
	WRITES: 
		allow system_server systemkeys_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow system_server systemkeys_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

shared_relro_file:dir 
	WRITES: 
		allow shared_relro shared_relro_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	READS: 
		allow appdomain shared_relro_file:dir search;
		allow debuggerd shared_relro_file:dir {#open#getattr#read#search#ioctl#};
		allow shared_relro shared_relro_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
	NEVERALLOWS: 

alarm_device:chr_file 
	WRITES: 
		allow radio alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain alarm_device:chr_file {#getattr#open#read#ioctl#lock#};
		allow radio alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server alarm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

wpa_socket:sock_file 
	WRITES: 
		allow hostapd wpa_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server system_wpa_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server wpa_socket:sock_file unlink;
		allow system_server wpa_socket:sock_file write;
		allow wpa system_wpa_socket:sock_file write;
		allow wpa wpa_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow wpa wpa_socket:sock_file write;
	READS: 
		allow hostapd wpa_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server system_wpa_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow wpa wpa_socket:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

cache_file:dir 
	WRITES: 
		allow install_recovery cache_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow platform_app cache_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server cache_file:dir {#relabelfrom#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#};
		allow uncrypt cache_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow untrusted_app cache_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow domain cache_file:dir {#open#getattr#read#search#ioctl#};
		allow install_recovery cache_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow platform_app cache_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server cache_file:dir {#relabelfrom#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#};
		allow uncrypt cache_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow untrusted_app cache_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

init:process 
	WRITES: 
		allow adbd init:process sigchld;
		allow bootanim init:process sigchld;
		allow debuggerd -init:process {#ptrace#getattr#};
		allow debuggerd init:process sigchld;
		allow dhcp init:process sigchld;
		allow domain init:process sigchld;
		allow drmserver init:process sigchld;
		allow dumpstate init:process sigchld;
		allow fingerprintd init:process sigchld;
		allow fsck init:process sigchld;
		allow gatekeeperd init:process sigchld;
		allow goldfish_setup init:process sigchld;
		allow gpsd init:process sigchld;
		allow hci_attach init:process sigchld;
		allow healthd init:process sigchld;
		allow inputflinger init:process sigchld;
		allow installd init:process sigchld;
		allow install_recovery init:process sigchld;
		allow kernel init:process share;
		allow kernel init:process transition;
		allow keystore init:process sigchld;
		allow lmkd init:process sigchld;
		allow logd init:process sigchld;
		allow mdnsd init:process sigchld;
		allow mediaserver init:process sigchld;
		allow mtp init:process sigchld;
		allow netd init:process sigchld;
		allow perfprofd init:process sigchld;
		allow racoon init:process sigchld;
		allow rild init:process sigchld;
		allow servicemanager init:process sigchld;
		allow shell init:process sigchld;
		allow slideshow init:process sigchld;
		allow surfaceflinger init:process sigchld;
		allow system_server init:process sigchld;
		allow tee init:process sigchld;
		allow toolbox init:process sigchld;
		allow tzdatacheck init:process sigchld;
		allow ueventd init:process sigchld;
		allow uncrypt init:process sigchld;
		allow vdc init:process sigchld;
		allow vold init:process sigchld;
		allow watchdogd init:process sigchld;
		allow wpa init:process sigchld;
		allow zygote init:process sigchld;
	READS: 
		allow debuggerd -init:process {#ptrace#getattr#};
		allow kernel init:process share;
	NEVERALLOWS: 
		neverallow domain init:process dyntransition;
		neverallow domain init:process ptrace;
		neverallow domain init:process transition;
		neverallow -kernel} init:process transition;

wpa:process 
	WRITES: 
		allow init wpa:process transition;
	READS: 
		allow servicemanager wpa:process getattr;
	NEVERALLOWS: 

vold_data_file:dir 
	WRITES: 
		allow init vold_data_file:dir {#open#create#read#getattr#setattr#search#};
		allow vold vold_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow init vold_data_file:dir {#open#create#read#getattr#setattr#search#};
		allow vold vold_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

system_server:file 
	WRITES: 
		allow lmkd system_server:file write;
	READS: 
		allow lmkd system_server:file {#getattr#open#read#ioctl#lock#};
		allow servicemanager system_server:file {#read#open#};
	NEVERALLOWS: 

mnt_media_rw_stub_file:dir 
	WRITES: 
		allow vold mnt_media_rw_stub_file:dir {#mounton#create#rmdir#getattr#setattr#};
	READS: 
		allow vold mnt_media_rw_stub_file:dir {#mounton#create#rmdir#getattr#setattr#};
	NEVERALLOWS: 

dm_device:blk_file 
	WRITES: 
		allow fsck dm_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init dm_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold dm_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow blkid dm_device:blk_file {#getattr#open#read#ioctl#lock#};
		allow fsck dm_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init dm_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold dm_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

misc_user_data_file:file 
	WRITES: 
		allow installd misc_user_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_app misc_user_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain misc_user_data_file:file {#getattr#open#read#ioctl#lock#};
		allow installd misc_user_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_app misc_user_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

anr_data_file:dir 
	WRITES: 
		allow dumpstate anr_data_file:dir {#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#relabelto#};
		allow system_app anr_data_file:dir {#{#open#getattr#read#search#ioctl#}#add_name#write#};
		allow system_server anr_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server anr_data_file:dir relabelto;
	READS: 
		allow adbd anr_data_file:dir {#open#getattr#read#search#ioctl#};
		allow appdomain anr_data_file:dir search;
		allow dumpstate anr_data_file:dir {#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#relabelto#};
		allow shell anr_data_file:dir {#open#getattr#read#search#ioctl#};
		allow system_app anr_data_file:dir {#{#open#getattr#read#search#ioctl#}#add_name#write#};
		allow system_server anr_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

cache_backup_file:dir 
	WRITES: 
		allow system_server cache_backup_file:dir {#relabelto#relabelfrom#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#};
	READS: 
		allow appdomain cache_backup_file:dir getattr;
		allow system_server cache_backup_file:dir {#relabelto#relabelfrom#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#};
	NEVERALLOWS: 

self:rawip_socket 
	WRITES: 
		allow clatd self:rawip_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow netdomain self:rawip_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	READS: 
		allow clatd self:rawip_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
		allow netdomain self:rawip_socket {#create#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#};
	NEVERALLOWS: 

sdcard_type:dir 
	WRITES: 
		allow adbd sdcard_type:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow init -sdcard_type:dir {#open#read#setattr#search#};
		allow sdcardd sdcard_type:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold sdcard_type:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow adbd sdcard_type:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow drmserver sdcard_type:dir search;
		allow init -sdcard_type:dir {#open#read#setattr#search#};
		allow mediaserver sdcard_type:dir {#open#getattr#read#search#ioctl#};
		allow rild sdcard_type:dir {#open#getattr#read#search#ioctl#};
		allow sdcardd sdcard_type:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server sdcard_type:dir {#getattr#search#};
		allow vold sdcard_type:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

qtaguid_proc:file 
	WRITES: 
		allow appdomain qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow mediaserver qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow appdomain qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow dumpstate qtaguid_proc:file {#getattr#open#read#ioctl#lock#};
		allow mediaserver qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server qtaguid_proc:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

-shell_data_file:sock_file 
	WRITES: 
		allow init -shell_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -shell_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

tombstone_data_file:dir 
	WRITES: 
		allow debuggerd tombstone_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow debuggerd tombstone_data_file:dir relabelto;
	READS: 
		allow debuggerd tombstone_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow dumpstate tombstone_data_file:dir {#open#getattr#read#search#ioctl#};
		allow system_server tombstone_data_file:dir {#open#getattr#read#search#ioctl#};
	NEVERALLOWS: 

kernel:fd 
	WRITES: 
		allow domain kernel:fd use;
	READS: 
		allow domain kernel:fd use;
	NEVERALLOWS: 

netd:netlink_kobject_uevent_socket 
	WRITES: 
		allow clatd netd:netlink_kobject_uevent_socket {#read#write#};
		allow dhcp netd:netlink_kobject_uevent_socket {#read#write#};
		allow dnsmasq netd:netlink_kobject_uevent_socket {#read#write#};
		allow hostapd netd:netlink_kobject_uevent_socket {#read#write#};
	READS: 
		allow clatd netd:netlink_kobject_uevent_socket {#read#write#};
		allow dhcp netd:netlink_kobject_uevent_socket {#read#write#};
		allow dnsmasq netd:netlink_kobject_uevent_socket {#read#write#};
		allow hostapd netd:netlink_kobject_uevent_socket {#read#write#};
	NEVERALLOWS: 

self:unix_stream_socket 
	WRITES: 
		allow domain self:unix_stream_socket {#{#create#{#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#listen#accept#}#}#connectto#};
	READS: 
		allow domain self:unix_stream_socket {#{#create#{#{#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#}#listen#accept#}#}#connectto#};
	NEVERALLOWS: 

hci_attach_tmpfs:file 
	WRITES: 
		allow hci_attach hci_attach_tmpfs:file {#read#write#};
	READS: 
		allow hci_attach hci_attach_tmpfs:file {#read#write#};
	NEVERALLOWS: 

fingerprintd:fd 
	WRITES: 
		allow system_server fingerprintd:fd use;
	READS: 
		allow system_server fingerprintd:fd use;
	NEVERALLOWS: 

system_server:unix_stream_socket 
	WRITES: 
		allow appdomain system_server:unix_stream_socket {#read#write#setopt#getattr#getopt#shutdown#};
		allow debuggerd system_server:unix_stream_socket connectto;
	READS: 
		allow appdomain system_server:unix_stream_socket {#read#write#setopt#getattr#getopt#shutdown#};
	NEVERALLOWS: 

gps_data_file:file 
	WRITES: 
		allow gpsd gps_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow gpsd gps_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

shell_data_file:sock_file 
	WRITES: 
		allow init -shell_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow installd shell_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	READS: 
		allow init -shell_data_file:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
		allow installd shell_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
	NEVERALLOWS: 

sdcard_type:file 
	WRITES: 
		allow adbd sdcard_type:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow drmserver sdcard_type:file {#read#write#getattr#};
		allow init -sdcard_type:file {#open#read#setattr#};
		allow kernel sdcard_type:file {#read#write#};
		allow mediaserver sdcard_type:file write;
		allow sdcardd sdcard_type:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow vold sdcard_type:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow adbd sdcard_type:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow drmserver sdcard_type:file {#read#write#getattr#};
		allow init -sdcard_type:file {#open#read#setattr#};
		allow kernel sdcard_type:file {#read#write#};
		allow mediaserver sdcard_type:file {#getattr#open#read#ioctl#lock#};
		allow sdcardd sdcard_type:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow vold sdcard_type:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

shell_tmpfs:file 
	WRITES: 
		allow shell shell_tmpfs:file {#read#write#};
	READS: 
		allow shell shell_tmpfs:file execute;
		allow shell shell_tmpfs:file {#read#write#};
	NEVERALLOWS: 

watchdog_device:chr_file 
	WRITES: 
		allow watchdogd watchdog_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow watchdogd watchdog_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

rpmsg_device:chr_file 
	WRITES: 
		allow mediaserver rpmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow mediaserver rpmsg_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

gps_device:chr_file 
	WRITES: 
		allow gpsd gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow gpsd gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow rild gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server gps_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

apk_private_tmp_file:file 
	WRITES: 
		allow platform_app apk_private_tmp_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server apk_private_tmp_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server apk_private_tmp_file:file {#relabelfrom#relabelto#};
	READS: 
		allow platform_app apk_private_tmp_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow system_server apk_private_tmp_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server apk_private_tmp_file:file {#relabelfrom#relabelto#};
		allow untrusted_app apk_private_tmp_file:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

console_device:chr_file 
	WRITES: 
		allow appdomain console_device:chr_file {#read#write#};
		allow binderservicedomain console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow appdomain console_device:chr_file {#read#write#};
		allow binderservicedomain console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow init console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow shell console_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

ppp_device:chr_file 
	WRITES: 
		allow ppp ppp_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow ppp ppp_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

rild_tmpfs:file 
	WRITES: 
		allow rild rild_tmpfs:file {#read#write#};
	READS: 
		allow rild rild_tmpfs:file {#read#write#};
	NEVERALLOWS: 

asec_public_file:file 
	WRITES: 
		allow system_server asec_public_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow vold asec_public_file:file {#relabelto#setattr#};
	READS: 
		allow domain asec_public_file:file {#getattr#open#read#ioctl#lock#};
		allow system_server asec_public_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow untrusted_app asec_public_file:file {#execute#execmod#};
	NEVERALLOWS: 

dalvikcache_data_file:file 
	WRITES: 
		allow dex2oat dalvikcache_data_file:file write;
		allow installd dalvikcache_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow installd dalvikcache_data_file:file {#relabelto#link#};
		allow zygote dalvikcache_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain dalvikcache_data_file:file execute;
		allow domain dalvikcache_data_file:file {#getattr#open#read#ioctl#lock#};
		allow dumpstate dalvikcache_data_file:file execute;
		allow installd dalvikcache_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server dalvikcache_data_file:file execute;
		allow zygote dalvikcache_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow zygote dalvikcache_data_file:file execute;
	NEVERALLOWS: 

efs_file:file 
	WRITES: 
		allow rild efs_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow vold efs_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow bluetooth bluetooth_efs_file:file {#getattr#open#read#ioctl#lock#};
		allow drmserver efs_file:file {#getattr#open#read#ioctl#lock#};
		allow hci_attach bluetooth_efs_file:file {#getattr#open#read#ioctl#lock#};
		allow rild bluetooth_efs_file:file {#getattr#open#read#ioctl#lock#};
		allow rild efs_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow ueventd efs_file:file {#getattr#open#read#ioctl#lock#};
		allow vold efs_file:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow appdomain efs_file:file write;
		neverallow appdomain efs_file:file read;
		neverallow -shell efs_file:file read;

-healthd:process 
	WRITES: 
		allow debuggerd -healthd:process {#ptrace#getattr#};
	READS: 
		allow debuggerd -healthd:process {#ptrace#getattr#};
	NEVERALLOWS: 

mediaserver:tcp_socket 
	WRITES: 
		allow system_server mediaserver:tcp_socket {#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#};
	READS: 
		allow system_server mediaserver:tcp_socket {#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#};
	NEVERALLOWS: 

netd:udp_socket 
	WRITES: 
		allow clatd netd:udp_socket {#read#write#};
		allow dhcp netd:udp_socket {#read#write#};
		allow dnsmasq netd:udp_socket {#read#write#};
		allow hostapd netd:udp_socket {#read#write#};
	READS: 
		allow clatd netd:udp_socket {#read#write#};
		allow dhcp netd:udp_socket {#read#write#};
		allow dnsmasq netd:udp_socket {#read#write#};
		allow hostapd netd:udp_socket {#read#write#};
	NEVERALLOWS: 

metadata_block_device:blk_file 
	WRITES: 
		allow init metadata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold metadata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow init metadata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold metadata_block_device:blk_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

appdomain:udp_socket 
	WRITES: 
		allow system_server appdomain:udp_socket {#getattr#getopt#setopt#read#write#shutdown#};
	READS: 
		allow system_server appdomain:udp_socket {#getattr#getopt#setopt#read#write#shutdown#};
	NEVERALLOWS: 

fuse:file 
	WRITES: 
		allow appdomain fuse:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow appdomain fuse:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

fscklogs:file 
	WRITES: 
		allow init fscklogs:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server fscklogs:file unlink;
		allow vold fscklogs:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow init fscklogs:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server fscklogs:file {#getattr#open#read#ioctl#lock#};
		allow vold fscklogs:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

proc_uid_cputime_removeuid:file 
	WRITES: 
		allow system_server proc_uid_cputime_removeuid:file {#{#open#append#write#}#getattr#};
	READS: 
		allow system_server proc_uid_cputime_removeuid:file {#{#open#append#write#}#getattr#};
	NEVERALLOWS: 

apk_data_file:dir 
	WRITES: 
		allow drmserver apk_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow installd apk_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#};
		allow system_server apk_data_file:dir {#relabelfrom#relabelto#};
		allow system_server apk_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold apk_data_file:dir {#create#getattr#setattr#};
	READS: 
		allow appdomain apk_data_file:dir {#open#getattr#read#search#ioctl#};
		allow domain apk_data_file:dir {#getattr#search#};
		allow drmserver apk_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow installd apk_data_file:dir {#{#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#}#relabelfrom#};
		allow shell apk_data_file:dir {#open#getattr#read#search#ioctl#};
		allow system_server apk_data_file:dir {#relabelfrom#relabelto#};
		allow system_server apk_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold apk_data_file:dir {#create#getattr#setattr#};
	NEVERALLOWS: 

tombstone_data_file:file 
	WRITES: 
		allow debuggerd tombstone_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow debuggerd tombstone_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow dumpstate tombstone_data_file:file {#getattr#open#read#ioctl#lock#};
		allow system_server tombstone_data_file:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

cache_file:file 
	WRITES: 
		allow install_recovery cache_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow platform_app cache_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server cache_file:file {#relabelfrom#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#};
		allow uncrypt cache_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow untrusted_app cache_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow domain cache_file:file {#getattr#read#};
		allow install_recovery cache_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow platform_app cache_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server cache_file:file {#relabelfrom#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#};
		allow uncrypt cache_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow untrusted_app cache_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

netdomain:tun_socket} 
	WRITES: 
		allow netd netdomain:tun_socket} {read#write#getattr#setattr#getopt#setopt};
	READS: 
		allow netd netdomain:tun_socket} {read#write#getattr#setattr#getopt#setopt};
	NEVERALLOWS: 

-keystore_data_file:lnk_file 
	WRITES: 
		allow init -keystore_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	READS: 
		allow init -keystore_data_file:lnk_file {#create#getattr#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

mtp:unix_dgram_socket 
	WRITES: 
		allow ppp mtp:unix_dgram_socket {#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#};
	READS: 
		allow ppp mtp:unix_dgram_socket {#ioctl#read#getattr#write#setattr#lock#append#bind#connect#getopt#setopt#shutdown#};
	NEVERALLOWS: 

cache_file:fifo_file 
	WRITES: 
		allow system_server cache_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow uncrypt cache_file:fifo_file {#open#append#write#};
	READS: 
		allow system_server cache_file:fifo_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

-exec_type:sock_file 
	WRITES: 
		allow init -exec_type:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -exec_type:sock_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

tzdatacheck_tmpfs:file 
	WRITES: 
		allow tzdatacheck tzdatacheck_tmpfs:file {#read#write#};
	READS: 
		allow tzdatacheck tzdatacheck_tmpfs:file {#read#write#};
	NEVERALLOWS: 

urandom_device:chr_file 
	WRITES: 
		allow domain urandom_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow domain urandom_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

wifi_data_file:dir 
	WRITES: 
		allow hostapd wifi_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow netd wifi_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server wifi_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow wpa wifi_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow hostapd wifi_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow netd wifi_data_file:dir {#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#};
		allow system_server wifi_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow wpa wifi_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

-kmem_device:chr_file 
	WRITES: 
		allow init -kmem_device:chr_file {#read#open#setattr#};
	READS: 
		allow init -kmem_device:chr_file {#read#open#setattr#};
	NEVERALLOWS: 

cache_backup_file:file 
	WRITES: 
		allow appdomain cache_backup_file:file {#read#write#getattr#};
		allow system_server cache_backup_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server cache_backup_file:file {#relabelto#relabelfrom#};
	READS: 
		allow appdomain cache_backup_file:file {#read#write#getattr#};
		allow system_server cache_backup_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow system_server cache_backup_file:file {#relabelto#relabelfrom#};
	NEVERALLOWS: 

tee_tmpfs:file 
	WRITES: 
		allow tee tee_tmpfs:file {#read#write#};
	READS: 
		allow tee tee_tmpfs:file {#read#write#};
	NEVERALLOWS: 

tmpfs:dir 
	WRITES: 
		allow init tmpfs:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow init tmpfs:dir mounton;
		allow vold tmpfs:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold tmpfs:dir mounton;
	READS: 
		allow domain tmpfs:dir {#open#getattr#read#search#ioctl#};
		allow init tmpfs:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow init tmpfs:dir mounton;
		allow init tmpfs:dir relabelfrom;
		allow vold tmpfs:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow vold tmpfs:dir mounton;
	NEVERALLOWS: 

dhcp_data_file:file 
	WRITES: 
		allow dhcp dhcp_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow dnsmasq dhcp_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow dhcp dhcp_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow dnsmasq dhcp_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

init:fd 
	WRITES: 
		allow domain init:fd use;
	READS: 
		allow domain init:fd use;
	NEVERALLOWS: 

self:process 
	WRITES: 
		allow appdomain self:process ptrace;
		allow init self:process {#setexec#setfscreate#setsockcreate#};
		allow runas self:process setcurrent;
		allow system_server self:process ptrace;
		allow ueventd self:process setfscreate;
		allow vold self:process setexec;
		allow vold self:process setfscreate;
		allow zygote self:process setcurrent;
	READS: 
		allow appdomain self:process ptrace;
		allow system_server self:process ptrace;
	NEVERALLOWS: 

radio_tmpfs:file 
	WRITES: 
		allow radio radio_tmpfs:file {#read#write#};
	READS: 
		allow radio radio_tmpfs:file execute;
		allow radio radio_tmpfs:file {#read#write#};
	NEVERALLOWS: 

backup_data_file:dir 
	WRITES: 
		allow system_server backup_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server backup_data_file:dir {#relabelto#relabelfrom#};
	READS: 
		allow system_server backup_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
		allow system_server backup_data_file:dir {#relabelto#relabelfrom#};
	NEVERALLOWS: 

debugfs:file 
	WRITES: 
		allow domain debugfs:file {#open#append#write#};
	READS: 
		allow dumpstate debugfs:file {#getattr#open#read#ioctl#lock#};
		allow shell debugfs:file {#getattr#open#read#ioctl#lock#};
		allow system_server debugfs:file {#getattr#open#read#ioctl#lock#};
	NEVERALLOWS: 

usermodehelper:file 
	WRITES: 
		allow init usermodehelper:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow init usermodehelper:file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 
		neverallow domain usermodehelper:file {#append#write#};
		neverallow -init usermodehelper:file {#append#write#};

untrusted_app_devpts:chr_file 
	WRITES: 
		allow untrusted_app untrusted_app_devpts:chr_file {#open#getattr#read#write#ioctl#};
	READS: 
		allow untrusted_app untrusted_app_devpts:chr_file {#open#getattr#read#write#ioctl#};
	NEVERALLOWS: 

surfaceflinger:fd 
	WRITES: 
		allow adbd surfaceflinger:fd use;
		allow bootanim surfaceflinger:fd use;
	READS: 
		allow adbd surfaceflinger:fd use;
		allow bootanim surfaceflinger:fd use;
	NEVERALLOWS: 

gatekeeperd:process 
	WRITES: 
		allow init gatekeeperd:process transition;
	READS: 
		allow servicemanager gatekeeperd:process getattr;
	NEVERALLOWS: 

-keystore_data_file:fifo_file 
	WRITES: 
		allow init -keystore_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -keystore_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

mnt_user_file:lnk_file 
	WRITES: 
		allow vold mnt_user_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow zygote mnt_user_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow adbd mnt_user_file:lnk_file {#getattr#open#read#ioctl#lock#};
		allow appdomain mnt_user_file:lnk_file {#getattr#open#read#ioctl#lock#};
		allow system_server mnt_user_file:lnk_file {#getattr#read#};
		allow vold mnt_user_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow zygote mnt_user_file:lnk_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

media_data_file:dir 
	WRITES: 
		allow mediaserver media_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow mediaserver media_data_file:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

dumpstate:fd 
	WRITES: 
		allow appdomain dumpstate:fd use;
		allow binderservicedomain dumpstate:fd use;
		allow surfaceflinger dumpstate:fd use;
		allow system_server dumpstate:fd use;
		allow vdc dumpstate:fd use;
	READS: 
		allow appdomain dumpstate:fd use;
		allow binderservicedomain dumpstate:fd use;
		allow surfaceflinger dumpstate:fd use;
		allow system_server dumpstate:fd use;
		allow vdc dumpstate:fd use;
	NEVERALLOWS: 

ueventd_tmpfs:file 
	WRITES: 
		allow ueventd ueventd_tmpfs:file {#read#write#};
	READS: 
		allow ueventd ueventd_tmpfs:file {#read#write#};
	NEVERALLOWS: 

netdomain:udp_socket 
	WRITES: 
		allow netd netdomain:udp_socket {read#write#getattr#setattr#getopt#setopt};
	READS: 
		allow netd netdomain:udp_socket {read#write#getattr#setattr#getopt#setopt};
	NEVERALLOWS: 

apk_data_file:file 
	WRITES: 
		allow installd apk_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#link#};
		allow system_server apk_data_file:file {#relabelfrom#relabelto#};
		allow system_server apk_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#link#};
	READS: 
		allow appdomain apk_data_file:file {#{#{#getattr#open#read#ioctl#lock#}#{#getattr#execute#execute_no_trans#}#}#execmod#};
		allow domain apk_data_file:file {#getattr#open#read#ioctl#lock#};
		allow drmserver apk_data_file:file {#read#getattr#};
		allow installd apk_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#link#};
		allow mediaserver apk_data_file:file {#read#getattr#};
		allow shell apk_data_file:file {#getattr#open#read#ioctl#lock#};
		allow system_server apk_data_file:file {#relabelfrom#relabelto#};
		allow system_server apk_data_file:file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#link#};
	NEVERALLOWS: 

nfc_data_file:sock_file 
	WRITES: 
		allow installd nfc_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow nfc nfc_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow installd nfc_data_file:sock_file {#{#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#}#relabelfrom#relabelto#};
		allow nfc nfc_data_file:sock_file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

fuse:dir 
	WRITES: 
		allow appdomain fuse:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	READS: 
		allow appdomain fuse:dir {#create#reparent#rename#rmdir#setattr#{#{#open#getattr#read#search#ioctl#}#{#open#search#write#add_name#remove_name#}#}#};
	NEVERALLOWS: 

zoneinfo_data_file:file 
	WRITES: 
		allow system_server zoneinfo_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
		allow tzdatacheck zoneinfo_data_file:file unlink;
	READS: 
		allow domain zoneinfo_data_file:file {#getattr#open#read#ioctl#lock#};
		allow system_server zoneinfo_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

appdomain:process 
	WRITES: 
		allow dumpstate appdomain:process signal;
		allow lmkd appdomain:process sigkill;
		allow system_server appdomain:process {#getsched#setsched#};
		allow system_server appdomain:process {#sigkill#signal#};
		allow zygote appdomain:process dyntransition;
		allow zygote appdomain:process {#getpgid#setpgid#};
	READS: 
		allow servicemanager appdomain:process getattr;
		allow system_server appdomain:process {#getsched#setsched#};
		allow zygote appdomain:process {#getpgid#setpgid#};
	NEVERALLOWS: 
		neverallow appdomain -appdomain:process ptrace;

audio_data_file:file 
	WRITES: 
		allow mediaserver audio_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	READS: 
		allow mediaserver audio_data_file:file {#create#rename#setattr#unlink#{#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#}#};
	NEVERALLOWS: 

rild:unix_stream_socket 
	WRITES: 
		allow bluetooth rild:unix_stream_socket connectto;
		allow mediaserver rild:unix_stream_socket {#connectto#read#write#setopt#};
		allow radio rild:unix_stream_socket connectto;
		allow system_server rild:unix_stream_socket connectto;
	READS: 
		allow mediaserver rild:unix_stream_socket {#connectto#read#write#setopt#};
	NEVERALLOWS: 

dm_device:chr_file 
	WRITES: 
		allow init dm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold dm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow init dm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
		allow vold dm_device:chr_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

vold_tmpfs:file 
	WRITES: 
		allow vold vold_tmpfs:file {#read#write#};
	READS: 
		allow vold vold_tmpfs:file {#read#write#};
	NEVERALLOWS: 

mdns_socket:sock_file 
	WRITES: 
		allow system_server mdns_socket:sock_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	READS: 
		allow system_server mdns_socket:sock_file {#{#getattr#open#read#ioctl#lock#}#{#open#append#write#}#};
	NEVERALLOWS: 

shared_relro_tmpfs:file 
	WRITES: 
		allow shared_relro shared_relro_tmpfs:file {#read#write#};
	READS: 
		allow shared_relro shared_relro_tmpfs:file execute;
		allow shared_relro shared_relro_tmpfs:file {#read#write#};
	NEVERALLOWS: 

-exec_type:dir 
	WRITES: 
		allow init -exec_type:dir {#create#search#getattr#open#read#setattr#ioctl#};
		allow init -exec_type:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	READS: 
		allow init -exec_type:dir {#create#search#getattr#open#read#setattr#ioctl#};
		allow init -exec_type:dir {#write#add_name#remove_name#rmdir#relabelfrom#};
	NEVERALLOWS: 

fsck_tmpfs:file 
	WRITES: 
		allow fsck fsck_tmpfs:file {#read#write#};
	READS: 
		allow fsck fsck_tmpfs:file {#read#write#};
	NEVERALLOWS: 

zygote_tmpfs:file 
	WRITES: 
		allow zygote zygote_tmpfs:file {#read#write#};
	READS: 
		allow appdomain zygote_tmpfs:file read;
		allow system_server zygote_tmpfs:file read;
		allow zygote zygote_tmpfs:file {#read#write#};
	NEVERALLOWS: 

-shell_data_file:fifo_file 
	WRITES: 
		allow init -shell_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	READS: 
		allow init -shell_data_file:fifo_file {#create#getattr#open#read#setattr#relabelfrom#unlink#};
	NEVERALLOWS: 

Bridging Objects = 457